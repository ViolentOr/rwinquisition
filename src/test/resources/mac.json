{"platform":{"name":"mac_os_x","release":"17.4.0"},"profiles":[{"name":"cis-appleosx10.11-level2","version":"1.0.0","sha256":"f623bb37c6e7fba43c7d68be805a06824fb073bef361897c2e3a62c0e5bda4eb","title":"CIS Apple OSX 10.11 Benchmark Level 2","maintainer":"Chef Software, Inc.","summary":"CIS Apple OSX 10.11 Benchmark Level 2 translated from SCAP","license":"Proprietary, All rights reserved","copyright":"Chef Software, Inc.","copyright_email":"support@chef.io","supports":[],"attributes":[],"groups":[{"id":"controls/translated-controls.rb","controls":["xccdf_org.cisecurity.benchmarks_rule_1.1_Verify_all_Apple_provided_software_is_current","xccdf_org.cisecurity.benchmarks_rule_1.2_Enable_Auto_Update","xccdf_org.cisecurity.benchmarks_rule_1.3_Enable_app_update_installs","xccdf_org.cisecurity.benchmarks_rule_1.4_Enable_system_data_files_and_security_update_installs","xccdf_org.cisecurity.benchmarks_rule_1.5_Enable_OS_X_update_installs","xccdf_org.cisecurity.benchmarks_rule_2.1.1_Turn_off_Bluetooth_if_no_paired_devices_exist","xccdf_org.cisecurity.benchmarks_rule_2.1.2_Turn_off_Bluetooth_Discoverable_mode_when_not_pairing_devices","xccdf_org.cisecurity.benchmarks_rule_2.1.3_Show_Bluetooth_status_in_menu_bar","xccdf_org.cisecurity.benchmarks_rule_2.2.1_Enable_Set_time_and_date_automatically","xccdf_org.cisecurity.benchmarks_rule_2.2.2_Ensure_time_set_is_within_appropriate_limits","xccdf_org.cisecurity.benchmarks_rule_2.3.1_Set_an_inactivity_interval_of_20_minutes_or_less_for_the_screen_saver","xccdf_org.cisecurity.benchmarks_rule_2.3.2_Secure_screen_saver_corners","xccdf_org.cisecurity.benchmarks_rule_2.3.3_Verify_Display_Sleep_is_set_to_a_value_larger_than_the_Screen_Saver","xccdf_org.cisecurity.benchmarks_rule_2.3.4_Set_a_screen_corner_to_Start_Screen_Saver","xccdf_org.cisecurity.benchmarks_rule_2.4.1_Disable_Remote_Apple_Events","xccdf_org.cisecurity.benchmarks_rule_2.4.2_Disable_Internet_Sharing","xccdf_org.cisecurity.benchmarks_rule_2.4.3_Disable_Screen_Sharing","xccdf_org.cisecurity.benchmarks_rule_2.4.4_Disable_Printer_Sharing","xccdf_org.cisecurity.benchmarks_rule_2.4.5_Disable_Remote_Login","xccdf_org.cisecurity.benchmarks_rule_2.4.6_Disable_DVD_or_CD_Sharing","xccdf_org.cisecurity.benchmarks_rule_2.4.7_Disable_Bluetooth_Sharing","xccdf_org.cisecurity.benchmarks_rule_2.4.8_Disable_File_Sharing","xccdf_org.cisecurity.benchmarks_rule_2.4.9_Disable_Remote_Management","xccdf_org.cisecurity.benchmarks_rule_2.5.1_Disable_Wake_for_network_access","xccdf_org.cisecurity.benchmarks_rule_2.5.2_Disable_sleeping_the_computer_when_connected_to_power","xccdf_org.cisecurity.benchmarks_rule_2.6.1_Enable_FileVault","xccdf_org.cisecurity.benchmarks_rule_2.6.2_Enable_Gatekeeper","xccdf_org.cisecurity.benchmarks_rule_2.6.3_Enable_Firewall","xccdf_org.cisecurity.benchmarks_rule_2.6.4_Enable_Firewall_Stealth_Mode","xccdf_org.cisecurity.benchmarks_rule_2.6.5_Review_Application_Firewall_Rules","xccdf_org.cisecurity.benchmarks_rule_2.7.1_iCloud_configuration","xccdf_org.cisecurity.benchmarks_rule_2.7.2_iCloud_keychain","xccdf_org.cisecurity.benchmarks_rule_2.7.3_iCloud_Drive","xccdf_org.cisecurity.benchmarks_rule_2.8_Pair_the_remote_control_infrared_receiver_if_enabled","xccdf_org.cisecurity.benchmarks_rule_2.9_Enable_Secure_Keyboard_Entry_in_terminal.app","xccdf_org.cisecurity.benchmarks_rule_2.10_Java_6_is_not_the_default_Java_runtime","xccdf_org.cisecurity.benchmarks_rule_2.11_Securely_delete_files_as_needed","xccdf_org.cisecurity.benchmarks_rule_3.1.1_Retain_system.log_for_90_or_more_days","xccdf_org.cisecurity.benchmarks_rule_3.1.2_Retain_appfirewall.log_for_90_or_more_days","xccdf_org.cisecurity.benchmarks_rule_3.1.3_Retain_authd.log_for_90_or_more_days","xccdf_org.cisecurity.benchmarks_rule_3.2_Enable_security_auditing","xccdf_org.cisecurity.benchmarks_rule_3.3_Configure_Security_Auditing_Flags","xccdf_org.cisecurity.benchmarks_rule_3.4_Enable_remote_logging_for_Desktops_on_trusted_networks","xccdf_org.cisecurity.benchmarks_rule_3.5_Retain_install.log_for_365_or_more_days","xccdf_org.cisecurity.benchmarks_rule_4.1_Disable_Bonjour_advertising_service","xccdf_org.cisecurity.benchmarks_rule_4.2_Enable_Show_Wi-Fi_status_in_menu_bar","xccdf_org.cisecurity.benchmarks_rule_4.3_Create_network_specific_locations","xccdf_org.cisecurity.benchmarks_rule_4.4_Ensure_http_server_is_not_running","xccdf_org.cisecurity.benchmarks_rule_4.5_Ensure_ftp_server_is_not_running","xccdf_org.cisecurity.benchmarks_rule_4.6_Ensure_nfs_server_is_not_running","xccdf_org.cisecurity.benchmarks_rule_5.1.1_Secure_Home_Folders","xccdf_org.cisecurity.benchmarks_rule_5.1.2_Check_System_Wide_Applications_for_appropriate_permissions","xccdf_org.cisecurity.benchmarks_rule_5.1.3_Check_System_folder_for_world_writable_files","xccdf_org.cisecurity.benchmarks_rule_5.1.4_Check_Library_folder_for_world_writable_files","xccdf_org.cisecurity.benchmarks_rule_5.2.1_Configure_account_lockout_threshold","xccdf_org.cisecurity.benchmarks_rule_5.2.2_Set_a_minimum_password_length","xccdf_org.cisecurity.benchmarks_rule_5.2.3_Complex_passwords_must_contain_an_Alphabetic_Character","xccdf_org.cisecurity.benchmarks_rule_5.2.4_Complex_passwords_must_contain_a_Numeric_Character","xccdf_org.cisecurity.benchmarks_rule_5.2.5_Complex_passwords_must_contain_a_Special_Character","xccdf_org.cisecurity.benchmarks_rule_5.2.6_Complex_passwords_must_uppercase_and_lowercase_letters","xccdf_org.cisecurity.benchmarks_rule_5.2.7_Password_Age","xccdf_org.cisecurity.benchmarks_rule_5.2.8_Password_History","xccdf_org.cisecurity.benchmarks_rule_5.3_Reduce_the_sudo_timeout_period","xccdf_org.cisecurity.benchmarks_rule_5.4_Automatically_lock_the_login_keychain_for_inactivity","xccdf_org.cisecurity.benchmarks_rule_5.5_Ensure_login_keychain_is_locked_when_the_computer_sleeps","xccdf_org.cisecurity.benchmarks_rule_5.6_Enable_OCSP_and_CRL_certificate_checking","xccdf_org.cisecurity.benchmarks_rule_5.7_Do_not_enable_the_root_account","xccdf_org.cisecurity.benchmarks_rule_5.8_Disable_automatic_login","xccdf_org.cisecurity.benchmarks_rule_5.9_Require_a_password_to_wake_the_computer_from_sleep_or_screen_saver","xccdf_org.cisecurity.benchmarks_rule_5.10_Require_an_administrator_password_to_access_system-wide_preferences","xccdf_org.cisecurity.benchmarks_rule_5.11_Disable_ability_to_login_to_another_users_active_and_locked_session","xccdf_org.cisecurity.benchmarks_rule_5.12_Create_a_custom_message_for_the_Login_Screen","xccdf_org.cisecurity.benchmarks_rule_5.13_Create_a_Login_window_banner","xccdf_org.cisecurity.benchmarks_rule_5.14_Do_not_enter_a_password-related_hint","xccdf_org.cisecurity.benchmarks_rule_5.15_Disable_Fast_User_Switching","xccdf_org.cisecurity.benchmarks_rule_5.16_Secure_individual_keychains_and_items","xccdf_org.cisecurity.benchmarks_rule_5.17_Create_specialized_keychains_for_different_purposes","xccdf_org.cisecurity.benchmarks_rule_5.18_System_Integrity_Protection_status","xccdf_org.cisecurity.benchmarks_rule_5.19_Install_an_approved_tokend_for_smartcard_authentication_","xccdf_org.cisecurity.benchmarks_rule_6.1.1_Display_login_window_as_name_and_password","xccdf_org.cisecurity.benchmarks_rule_6.1.2_Disable_Show_password_hints","xccdf_org.cisecurity.benchmarks_rule_6.1.3_Disable_guest_account_login","xccdf_org.cisecurity.benchmarks_rule_6.1.4_Disable_Allow_guests_to_connect_to_shared_folders","xccdf_org.cisecurity.benchmarks_rule_6.2_Turn_on_filename_extensions","xccdf_org.cisecurity.benchmarks_rule_6.3_Disable_the_automatic_run_of_safe_files_in_Safari","xccdf_org.cisecurity.benchmarks_rule_6.4_Use_parental_controls_for_systems_that_are_not_centrally_managed","xccdf_org.cisecurity.benchmarks_rule_7.1_Wireless_technology_on_OS_X","xccdf_org.cisecurity.benchmarks_rule_7.2_iSight_Camera_Privacy_and_Confidentiality_Concerns","xccdf_org.cisecurity.benchmarks_rule_7.3_Computer_Name_Considerations","xccdf_org.cisecurity.benchmarks_rule_7.4_Software_Inventory_Considerations","xccdf_org.cisecurity.benchmarks_rule_7.5_Firewall_Consideration","xccdf_org.cisecurity.benchmarks_rule_7.6_Automatic_Actions_for_Optical_Media","xccdf_org.cisecurity.benchmarks_rule_7.7_App_Store_Automatically_download_apps_purchased_on_other_Macs_Considerations","xccdf_org.cisecurity.benchmarks_rule_7.8_Extensible_Firmware_Interface_EFI_password","xccdf_org.cisecurity.benchmarks_rule_7.9_Apple_ID_password_reset","xccdf_org.cisecurity.benchmarks_rule_7.10_Repairing_permissions_is_no_longer_needed_with_10.11","xccdf_org.cisecurity.benchmarks_rule_7.11_App_Store_Password_Settings","xccdf_org.cisecurity.benchmarks_rule_8.1_Password_Policy_Plist_generated_through_OS_X_Server","xccdf_org.cisecurity.benchmarks_rule_8.2_Password_Policy_Plist_from_man_page"]}],"controls":[{"id":"xccdf_org.cisecurity.benchmarks_rule_1.1_Verify_all_Apple_provided_software_is_current","title":"Verify all Apple provided software is current","desc":"Software vendors release security patches and software updates for their products when security vulnerabilities are discovered. There is no simple way to complete this action without a network connection to an Apple software repository. Please ensure appropriate access for this control. This check is only for what Apple provides through software update.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_1.1_Verify_all_Apple_provided_software_is_current\" do\n  title \"Verify all Apple provided software is current\"\n  desc  \"Software vendors release security patches and software updates for their products when security vulnerabilities are discovered. There is no simple way to complete this action without a network connection to an Apple software repository. Please ensure appropriate access for this control. This check is only for what Apple provides through software update.\"\n  impact 1.0\n  describe bash(\"/usr/sbin/softwareupdate -l 2>&1\") do\n    its(\"stdout\") { should match /No new software available/ }\n  end\nend\n","source_location":{"line":1,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command /usr/sbin/softwareupdate -l 2>&1 stdout should match /No new software available/","run_time":6.152087,"start_time":"2018-03-08T18:55:34+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_1.2_Enable_Auto_Update","title":"Enable Auto Update","desc":"Auto Update verifies that your system has the newest security patches and software updates. If \"Automatically check for updates\" is not selected background updates for new malware definition files from Apple for XProtect and Gatekeeper will not occur.\n             http://macops.ca/os-x-admins-your-clients-are-not-getting-background-security-updates/ https://derflounder.wordpress.com/2014/12/17/forcing-xprotect-blacklist-updates-on-mavericks-and-yosemite/","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_1.2_Enable_Auto_Update\" do\n  title \"Enable Auto Update\"\n  desc  \"Auto Update verifies that your system has the newest security patches and software updates. If \\\"Automatically check for updates\\\" is not selected background updates for new malware definition files from Apple for XProtect and Gatekeeper will not occur.\\n             http://macops.ca/os-x-admins-your-clients-are-not-getting-background-security-updates/ https://derflounder.wordpress.com/2014/12/17/forcing-xprotect-blacklist-updates-on-mavericks-and-yosemite/\"\n  impact 1.0\n  describe bash(\"defaults read /Library/Preferences/com.apple.SoftwareUpdate AutomaticCheckEnabled\") do\n    its(\"stdout\") { should match /1/ }\n  end\nend\n","source_location":{"line":10,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command defaults read /Library/Preferences/com.apple.SoftwareUpdate AutomaticCheckEnabled stdout should match /1/","run_time":0.067643,"start_time":"2018-03-08T18:55:40+03:00","message":"expected \"\" to match /1/\nDiff:\n@@ -1,2 +1,2 @@\n-/1/\n+\"\"\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_1.3_Enable_app_update_installs","title":"Enable app update installs","desc":"Ensure that application updates are installed after they are available from Apple. These updates do not require reboots or admin privileges for end users.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_1.3_Enable_app_update_installs\" do\n  title \"Enable app update installs\"\n  desc  \"Ensure that application updates are installed after they are available from Apple. These updates do not require reboots or admin privileges for end users.\"\n  impact 1.0\n  describe bash(\"defaults read /Library/Preferences/com.apple.storeagent AutoUpdate\") do\n    its(\"stdout\") { should match /^1$/ }\n  end\nend\n","source_location":{"line":19,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command defaults read /Library/Preferences/com.apple.storeagent AutoUpdate stdout should match /^1$/","run_time":0.041848,"start_time":"2018-03-08T18:55:41+03:00","message":"expected \"\" to match /^1$/\nDiff:\n@@ -1,2 +1,2 @@\n-/^1$/\n+\"\"\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_1.4_Enable_system_data_files_and_security_update_installs","title":"Enable system data files and security update installs","desc":"Ensure that system and security updates are installed after they are available from Apple. This setting enables definition updates for XProtect and Gatekeeper, with this setting in place new malware and adware that Apple has added to the list of malware or untrusted software will not execute. These updates do not require reboots or end user admin rights. http://www.thesafemac.com/tag/xprotect/ https://support.apple.com/en-us/HT202491","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_1.4_Enable_system_data_files_and_security_update_installs\" do\n  title \"Enable system data files and security update installs\"\n  desc  \"Ensure that system and security updates are installed after they are available from Apple. This setting enables definition updates for XProtect and Gatekeeper, with this setting in place new malware and adware that Apple has added to the list of malware or untrusted software will not execute. These updates do not require reboots or end user admin rights. http://www.thesafemac.com/tag/xprotect/ https://support.apple.com/en-us/HT202491\"\n  impact 1.0\n  describe bash(\"defaults read /Library/Preferences/com.apple.SoftwareUpdate | egrep 'ConfigDataInstall'\") do\n    its(\"stdout\") { should match /ConfigDataInstall = 1;/ }\n  end\n  describe bash(\"defaults read /Library/Preferences/com.apple.SoftwareUpdate | egrep 'CriticalUpdateInstall'\") do\n    its(\"stdout\") { should match /CriticalUpdateInstall = 1;/ }\n  end\nend\n","source_location":{"line":28,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command defaults read /Library/Preferences/com.apple.SoftwareUpdate | egrep 'ConfigDataInstall' stdout should match /ConfigDataInstall = 1;/","run_time":0.042334,"start_time":"2018-03-08T18:55:41+03:00","message":"expected \"\" to match /ConfigDataInstall = 1;/\nDiff:\n@@ -1,2 +1,2 @@\n-/ConfigDataInstall = 1;/\n+\"\"\n"},{"status":"failed","code_desc":"Bash command defaults read /Library/Preferences/com.apple.SoftwareUpdate | egrep 'CriticalUpdateInstall' stdout should match /CriticalUpdateInstall = 1;/","run_time":0.041834,"start_time":"2018-03-08T18:55:41+03:00","message":"expected \"\" to match /CriticalUpdateInstall = 1;/\nDiff:\n@@ -1,2 +1,2 @@\n-/CriticalUpdateInstall = 1;/\n+\"\"\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_1.5_Enable_OS_X_update_installs","title":"Enable OS X update installs","desc":"Ensure that OS X updates are installed after they are available from Apple. This setting enables OS X updates to be automatically installed. Some environments will want to approve and test updates before they are delivered and where updates can cause disruption to operations that is best practice. Automatic updates should be turned off where changes are tightly controlled and there are mature testing and approval processes. Automatic updates should not be turned off so the admin can call the users first to let them know it's ok to install. A dependable repeatable process involving a patch agent or remote management tool should be in place before auto-updates are turned off.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_1.5_Enable_OS_X_update_installs\" do\n  title \"Enable OS X update installs\"\n  desc  \"Ensure that OS X updates are installed after they are available from Apple. This setting enables OS X updates to be automatically installed. Some environments will want to approve and test updates before they are delivered and where updates can cause disruption to operations that is best practice. Automatic updates should be turned off where changes are tightly controlled and there are mature testing and approval processes. Automatic updates should not be turned off so the admin can call the users first to let them know it's ok to install. A dependable repeatable process involving a patch agent or remote management tool should be in place before auto-updates are turned off.\"\n  impact 1.0\n  describe bash(\"defaults read /Library/Preferences/com.apple.commerce AutoUpdateRestartRequired\") do\n    its(\"stdout\") { should match /1/ }\n  end\nend\n","source_location":{"line":40,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command defaults read /Library/Preferences/com.apple.commerce AutoUpdateRestartRequired stdout should match /1/","run_time":0.04807,"start_time":"2018-03-08T18:55:41+03:00","message":"expected \"\" to match /1/\nDiff:\n@@ -1,2 +1,2 @@\n-/1/\n+\"\"\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.1.1_Turn_off_Bluetooth_if_no_paired_devices_exist","title":"Turn off Bluetooth, if no paired devices exist","desc":"Bluetooth devices use a wireless communications system that replaces the cables used by other peripherals to connect to a system. It is by design a peer-to-peer network technology and typically lacks centralized administration and security enforcement infrastructure.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.1.1_Turn_off_Bluetooth_if_no_paired_devices_exist\" do\n  title \"Turn off Bluetooth, if no paired devices exist\"\n  desc  \"Bluetooth devices use a wireless communications system that replaces the cables used by other peripherals to connect to a system. It is by design a peer-to-peer network technology and typically lacks centralized administration and security enforcement infrastructure.\"\n  impact 1.0\n  describe bash(\"STATE=$(defaults read /Library/Preferences/com.apple.Bluetooth ControllerPowerState); PAIRED=$(system_profiler SPBluetoothDataType | grep \\\"Connectable\\\" | awk '{print $2}'); echo \\\"Enabled=$STATE;Paired=$PAIRED\\\"\") do\n    its(\"stdout\") { should match /^(Enabled=0|Enabled=1;Paired=Yes)/ }\n  end\nend\n","source_location":{"line":49,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command STATE=$(defaults read /Library/Preferences/com.apple.Bluetooth ControllerPowerState); PAIRED=$(system_profiler SPBluetoothDataType | grep \"Connectable\" | awk '{print $2}'); echo \"Enabled=$STATE;Paired=$PAIRED\" stdout should match /^(Enabled=0|Enabled=1;Paired=Yes)/","run_time":0.295824,"start_time":"2018-03-08T18:55:41+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.1.2_Turn_off_Bluetooth_Discoverable_mode_when_not_pairing_devices","title":"Turn off Bluetooth \"Discoverable\" mode when not pairing devices","desc":"When Bluetooth is set to discoverable mode, the Mac sends a signal indicating that it's available to pair with another Bluetooth device. When a device is \"discoverable\" it broadcasts information about itself and it's location. Starting with OS X 10.9 Discoverable mode is enabled while the Bluetooth System Preference is open and turned off once closed. Systems that have the Bluetooth System Preference open at the time of audit will show as Discoverable.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.1.2_Turn_off_Bluetooth_Discoverable_mode_when_not_pairing_devices\" do\n  title \"Turn off Bluetooth \\\"Discoverable\\\" mode when not pairing devices\"\n  desc  \"When Bluetooth is set to discoverable mode, the Mac sends a signal indicating that it's available to pair with another Bluetooth device. When a device is \\\"discoverable\\\" it broadcasts information about itself and it's location. Starting with OS X 10.9 Discoverable mode is enabled while the Bluetooth System Preference is open and turned off once closed. Systems that have the Bluetooth System Preference open at the time of audit will show as Discoverable.\"\n  impact 1.0\n  describe bash(\"system_profiler SPBluetoothDataType | grep \\\"Discoverable:\\\"\") do\n    its(\"stdout\") { should match /Off/ }\n  end\nend\n","source_location":{"line":58,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command system_profiler SPBluetoothDataType | grep \"Discoverable:\" stdout should match /Off/","run_time":0.259612,"start_time":"2018-03-08T18:55:41+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.1.3_Show_Bluetooth_status_in_menu_bar","title":"Show Bluetooth status in menu bar","desc":"By showing the Bluetooth status in the menu bar, a small Bluetooth icon is placed in the menu bar. This icon quickly shows the status of Bluetooth, and can allow the user to quickly turn Bluetooth on or off.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.1.3_Show_Bluetooth_status_in_menu_bar\" do\n  title \"Show Bluetooth status in menu bar\"\n  desc  \"By showing the Bluetooth status in the menu bar, a small Bluetooth icon is placed in the menu bar. This icon quickly shows the status of Bluetooth, and can allow the user to quickly turn Bluetooth on or off.\"\n  impact 1.0\n  describe bash(\"for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/com.apple.systemuiserver; if [ -e $PREF.plist ]; then /bin/echo -n \\\"Checking User: '$i': \\\"; defaults read $PREF menuExtras 2>&1 | grep Bluetooth.menu || echo 'Not Set'; fi; done\") do\n    its(\"stdout\") { should_not match /Not Set$/ }\n  end\nend\n","source_location":{"line":67,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/com.apple.systemuiserver; if [ -e $PREF.plist ]; then /bin/echo -n \"Checking User: '$i': \"; defaults read $PREF menuExtras 2>&1 | grep Bluetooth.menu || echo 'Not Set'; fi; done stdout should not match /Not Set$/","run_time":0.050218,"start_time":"2018-03-08T18:55:41+03:00","message":"expected \"Checking User: '/Users/mac': Not Set\\n\" not to match /Not Set$/\nDiff:\n@@ -1,2 +1,2 @@\n-/Not Set$/\n+Checking User: '/Users/mac': Not Set\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.2.1_Enable_Set_time_and_date_automatically","title":"Enable \"Set time and date automatically\"","desc":"Correct date and time settings are required for authentication protocols, file creation, modification dates and log entries. Apple's automatic time update solution will enable an NTP server that is not controlled by the Application Firewall. Turning on \"Set time and date automatically\" allows other computers to connect to set their time and allows for exploit attempts against ntpd. It also allows for more accurate network detection and OS fingerprinting.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.2.1_Enable_Set_time_and_date_automatically\" do\n  title \"Enable \\\"Set time and date automatically\\\"\"\n  desc  \"Correct date and time settings are required for authentication protocols, file creation, modification dates and log entries. Apple's automatic time update solution will enable an NTP server that is not controlled by the Application Firewall. Turning on \\\"Set time and date automatically\\\" allows other computers to connect to set their time and allows for exploit attempts against ntpd. It also allows for more accurate network detection and OS fingerprinting.\"\n  impact 0.0\n  describe bash(\"systemsetup -getusingnetworktime \") do\n    its(\"stdout\") { should match /Network Time: On/ }\n  end\nend\n","source_location":{"line":76,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command systemsetup -getusingnetworktime  stdout should match /Network Time: On/","run_time":0.070211,"start_time":"2018-03-08T18:55:41+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.2.2_Ensure_time_set_is_within_appropriate_limits","title":"Ensure time set is within appropriate limits","desc":"Correct date and time settings are required for authentication protocols, file creation, modification dates and log entries. Ensure that time on the computer is within acceptable limits. Truly accurate time is measured within milliseconds, for this audit a drift under four and a half minutes passes the control check. Since Kerberos is one of the important features of OS X integration into Directory systems the guidance here is to warn you before there could be an impact to operations. From the perspective of accurate time this check is not strict, it may be too great for your organization, adjust to a smaller offset value as needed.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.2.2_Ensure_time_set_is_within_appropriate_limits\" do\n  title \"Ensure time set is within appropriate limits\"\n  desc  \"Correct date and time settings are required for authentication protocols, file creation, modification dates and log entries. Ensure that time on the computer is within acceptable limits. Truly accurate time is measured within milliseconds, for this audit a drift under four and a half minutes passes the control check. Since Kerberos is one of the important features of OS X integration into Directory systems the guidance here is to warn you before there could be an impact to operations. From the perspective of accurate time this check is not strict, it may be too great for your organization, adjust to a smaller offset value as needed.\"\n  impact 1.0\n  describe bash(\"ntpdate -d $(grep ^server /etc/ntp.conf|sed 's/^server //')|tail -1|sed 's/^.*offset //'\") do\n    its(\"stdout\") { should match /^-?([0-9]{1,2}|1[0-9]{2}|2[0-6][0-9])(\\.[0-9]+)? sec$/ }\n  end\nend\n","source_location":{"line":85,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command ntpdate -d $(grep ^server /etc/ntp.conf|sed 's/^server //')|tail -1|sed 's/^.*offset //' stdout should match /^-?([0-9]{1,2}|1[0-9]{2}|2[0-6][0-9])(\\.[0-9]+)? sec$/","run_time":6.972183,"start_time":"2018-03-08T18:55:41+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.3.1_Set_an_inactivity_interval_of_20_minutes_or_less_for_the_screen_saver","title":"Set an inactivity interval of 20 minutes or less for the screen saver","desc":"A locking screensaver is one of the standard security controls to limit access to a computer and the current user's session when the computer is temporarily unused or unattended. In OS X the screensaver starts after a value selected in a drop down menu, 10 minutes and 20 minutes are both options and either is acceptable. Any value can be selected through the command line or script but a number that is not reflected in the GUI can be problematic. 20 minutes is the default for new accounts.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.3.1_Set_an_inactivity_interval_of_20_minutes_or_less_for_the_screen_saver\" do\n  title \"Set an inactivity interval of 20 minutes or less for the screen saver\"\n  desc  \"A locking screensaver is one of the standard security controls to limit access to a computer and the current user's session when the computer is temporarily unused or unattended. In OS X the screensaver starts after a value selected in a drop down menu, 10 minutes and 20 minutes are both options and either is acceptable. Any value can be selected through the command line or script but a number that is not reflected in the GUI can be problematic. 20 minutes is the default for new accounts.\"\n  impact 1.0\n  describe bash(\"UUID=`ioreg -rd1 -c IOPlatformExpertDevice | grep \\\"IOPlatformUUID\\\" | sed -e 's/^.* \\\"\\\\(.*\\\\)\\\"$/\\\\1/'`; for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/ByHost/com.apple.screensaver.$UUID; if [ -e $PREF.plist ]; then /bin/echo -n \\\"Checking User: '$i': \\\"; defaults read $PREF.plist idleTime 2>&1; fi; done\") do\n    its(\"stdout\") { should_not match /\\s0*(0|[1-9][0-9]{4,}|[2-9][0-9]{3}|1[3-9][0-9]{2}|12[1-9][0-9]|120[1-9])$/ }\n  end\nend\n","source_location":{"line":94,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command UUID=`ioreg -rd1 -c IOPlatformExpertDevice | grep \"IOPlatformUUID\" | sed -e 's/^.* \"\\(.*\\)\"$/\\1/'`; for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/ByHost/com.apple.screensaver.$UUID; if [ -e $PREF.plist ]; then /bin/echo -n \"Checking User: '$i': \"; defaults read $PREF.plist idleTime 2>&1; fi; done stdout should not match /\\s0*(0|[1-9][0-9]{4,}|[2-9][0-9]{3}|1[3-9][0-9]{2}|12[1-9][0-9]|120[1-9])$/","run_time":0.164888,"start_time":"2018-03-08T18:55:48+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.3.2_Secure_screen_saver_corners","title":"Secure screen saver corners","desc":"Hot Corners can be configured to disable the screen saver by moving the mouse cursor to a corner of the screen.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.3.2_Secure_screen_saver_corners\" do\n  title \"Secure screen saver corners\"\n  desc  \"Hot Corners can be configured to disable the screen saver by moving the mouse cursor to a corner of the screen.\"\n  impact 1.0\n  describe bash(\"for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/com.apple.dock; if [ -e $PREF.plist ]; then /bin/echo \\\"Checking User:$i; defaults read $PREF | egrep -i '(Checking User|corner)'; fi; done \") do\n    its(\"stdout\") { should_not match /[bltr]\\-corner\"\\s*=\\s*6/ }\n  end\nend\n","source_location":{"line":103,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/com.apple.dock; if [ -e $PREF.plist ]; then /bin/echo \"Checking User:$i; defaults read $PREF | egrep -i '(Checking User|corner)'; fi; done  stdout should not match /[bltr]\\-corner\"\\s*=\\s*6/","run_time":0.009208,"start_time":"2018-03-08T18:55:49+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.3.3_Verify_Display_Sleep_is_set_to_a_value_larger_than_the_Screen_Saver","title":"Verify Display Sleep is set to a value larger than the Screen Saver","desc":"If the Screen Saver is used to lock the screen, verify the Display Sleep settings are longer than the Screen Saver setting. If the display goes to sleep before the screen saver activates, the computer will appear to be off, but will be unprotected.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.3.3_Verify_Display_Sleep_is_set_to_a_value_larger_than_the_Screen_Saver\" do\n  title \"Verify Display Sleep is set to a value larger than the Screen Saver\"\n  desc  \"If the Screen Saver is used to lock the screen, verify the Display Sleep settings are longer than the Screen Saver setting. If the display goes to sleep before the screen saver activates, the computer will appear to be off, but will be unprotected.\"\n  impact 0.0\nend\n","source_location":{"line":112,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.3.4_Set_a_screen_corner_to_Start_Screen_Saver","title":"Set a screen corner to Start Screen Saver","desc":"The intent of this control is to resemble control-alt-delete on Windows Systems as a means of quickly locking the screen. If the user of the system is stepping away from the computer the best practice is to lock the screen and setting a hot corner is an appropriate method.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.3.4_Set_a_screen_corner_to_Start_Screen_Saver\" do\n  title \"Set a screen corner to Start Screen Saver\"\n  desc  \"The intent of this control is to resemble control-alt-delete on Windows Systems as a means of quickly locking the screen. If the user of the system is stepping away from the computer the best practice is to lock the screen and setting a hot corner is an appropriate method.\"\n  impact 1.0\n  describe bash(\"for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/com.apple.dock; if [ -e $PREF.plist ]; then /bin/echo -n \\\"Checking User '$i': \\\"; defaults read $PREF | egrep 'corner' | egrep '5;$' || echo \\\"Not set\\\"; fi; done\") do\n    its(\"stdout\") { should_not match /Not set$/ }\n  end\nend\n","source_location":{"line":118,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/com.apple.dock; if [ -e $PREF.plist ]; then /bin/echo -n \"Checking User '$i': \"; defaults read $PREF | egrep 'corner' | egrep '5;$' || echo \"Not set\"; fi; done stdout should not match /Not set$/","run_time":0.046189,"start_time":"2018-03-08T18:55:49+03:00","message":"expected \"Checking User '/Users/mac': Not set\\n\" not to match /Not set$/\nDiff:\n@@ -1,2 +1,2 @@\n-/Not set$/\n+Checking User '/Users/mac': Not set\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.4.1_Disable_Remote_Apple_Events","title":"Disable Remote Apple Events","desc":"Apple Events is a technology that allows one program to communicate with other programs. Remote Apple Events allows a program on one computer to communicate with a program on a different computer.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.4.1_Disable_Remote_Apple_Events\" do\n  title \"Disable Remote Apple Events\"\n  desc  \"Apple Events is a technology that allows one program to communicate with other programs. Remote Apple Events allows a program on one computer to communicate with a program on a different computer.\"\n  impact 1.0\n  describe bash(\"systemsetup -getremoteappleevents\") do\n    its(\"stdout\") { should_not match /Remote Apple Events: On/ }\n  end\nend\n","source_location":{"line":127,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command systemsetup -getremoteappleevents stdout should not match /Remote Apple Events: On/","run_time":0.054367,"start_time":"2018-03-08T18:55:49+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.4.2_Disable_Internet_Sharing","title":"Disable Internet Sharing","desc":"Internet Sharing uses the open source natd process to share an internet connection with other computers and devices on a local network. This allows the Mac to function as a router and share the connection to other, possibly unauthorized, devices.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.4.2_Disable_Internet_Sharing\" do\n  title \"Disable Internet Sharing\"\n  desc  \"Internet Sharing uses the open source natd process to share an internet connection with other computers and devices on a local network. This allows the Mac to function as a router and share the connection to other, possibly unauthorized, devices.\"\n  impact 1.0\n  describe bash(\"defaults read /Library/Preferences/SystemConfiguration/com.apple.nat\") do\n    its(\"stdout\") { should_not match /Enabled\\s*=\\s*1/ }\n  end\nend\n","source_location":{"line":136,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command defaults read /Library/Preferences/SystemConfiguration/com.apple.nat stdout should not match /Enabled\\s*=\\s*1/","run_time":0.042466,"start_time":"2018-03-08T18:55:49+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.4.3_Disable_Screen_Sharing","title":"Disable Screen Sharing","desc":"Screen sharing allows a computer to connect to another computer on a network and display the computer#x2019;s screen. While sharing the computer#x2019;s screen, the user can control what happens on that computer, such as opening documents or applications, opening, moving, or closing windows, and even shutting down the computer.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.4.3_Disable_Screen_Sharing\" do\n  title \"Disable Screen Sharing\"\n  desc  \"Screen sharing allows a computer to connect to another computer on a network and display the computer#x2019;s screen. While sharing the computer#x2019;s screen, the user can control what happens on that computer, such as opening documents or applications, opening, moving, or closing windows, and even shutting down the computer.\"\n  impact 1.0\n  describe bash(\"launchctl list | grep com.apple.screensharing\") do\n    its(\"stdout\") { should_not match /./ }\n  end\nend\n","source_location":{"line":145,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command launchctl list | grep com.apple.screensharing stdout should not match /./","run_time":0.027392,"start_time":"2018-03-08T18:55:49+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.4.4_Disable_Printer_Sharing","title":"Disable Printer Sharing","desc":"By enabling Printer sharing the computer is set up as a print server to accept print jobs from other computers. Dedicated print servers or direct IP printing should be used instead.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.4.4_Disable_Printer_Sharing\" do\n  title \"Disable Printer Sharing\"\n  desc  \"By enabling Printer sharing the computer is set up as a print server to accept print jobs from other computers. Dedicated print servers or direct IP printing should be used instead.\"\n  impact 1.0\n  describe bash(\"system_profiler SPPrintersDataType \") do\n    its(\"stdout\") { should_not match /Shared: Yes/ }\n  end\nend\n","source_location":{"line":154,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command system_profiler SPPrintersDataType  stdout should not match /Shared: Yes/","run_time":0.242476,"start_time":"2018-03-08T18:55:49+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.4.5_Disable_Remote_Login","title":"Disable Remote Login","desc":"Remote Login allows an interactive terminal connection to a computer.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.4.5_Disable_Remote_Login\" do\n  title \"Disable Remote Login\"\n  desc  \"Remote Login allows an interactive terminal connection to a computer.\"\n  impact 1.0\n  describe bash(\"launchctl list | grep com.openssh.sshd\") do\n    its(\"stdout\") { should_not match /./ }\n  end\nend\n","source_location":{"line":163,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command launchctl list | grep com.openssh.sshd stdout should not match /./","run_time":0.02601,"start_time":"2018-03-08T18:55:49+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.4.6_Disable_DVD_or_CD_Sharing","title":"Disable DVD or CD Sharing","desc":"DVD or CD Sharing allows users to remotely access the system's optical drive.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.4.6_Disable_DVD_or_CD_Sharing\" do\n  title \"Disable DVD or CD Sharing\"\n  desc  \"DVD or CD Sharing allows users to remotely access the system's optical drive.\"\n  impact 1.0\n  describe bash(\"launchctl list | egrep ODSAgent\") do\n    its(\"stdout\") { should_not match /./ }\n  end\nend\n","source_location":{"line":172,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command launchctl list | egrep ODSAgent stdout should not match /./","run_time":0.026512,"start_time":"2018-03-08T18:55:49+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.4.7_Disable_Bluetooth_Sharing","title":"Disable Bluetooth Sharing","desc":"Bluetooth Sharing allows files to be exchanged with Bluetooth enabled devices.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.4.7_Disable_Bluetooth_Sharing\" do\n  title \"Disable Bluetooth Sharing\"\n  desc  \"Bluetooth Sharing allows files to be exchanged with Bluetooth enabled devices.\"\n  impact 1.0\n  describe bash(\"UUID=`ioreg -rd1 -c IOPlatformExpertDevice | grep \\\"IOPlatformUUID\\\" | sed -e 's/^.* \\\"\\\\(.*\\\\)\\\"$/\\\\1/'`; for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/ByHost/com.apple.Bluetooth.$UUID; if [ -e $PREF.plist ]; then echo -n \\\"Checking User: '$i': \\\"; defaults read $PREF.plist PrefKeyServicesEnabled; fi; done\") do\n    its(\"stdout\") { should_not match /\\s1$/ }\n  end\nend\n","source_location":{"line":181,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command UUID=`ioreg -rd1 -c IOPlatformExpertDevice | grep \"IOPlatformUUID\" | sed -e 's/^.* \"\\(.*\\)\"$/\\1/'`; for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/ByHost/com.apple.Bluetooth.$UUID; if [ -e $PREF.plist ]; then echo -n \"Checking User: '$i': \"; defaults read $PREF.plist PrefKeyServicesEnabled; fi; done stdout should not match /\\s1$/","run_time":0.163043,"start_time":"2018-03-08T18:55:49+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.4.8_Disable_File_Sharing","title":"Disable File Sharing","desc":"Apple's File Sharing uses a combination of SMB (Windows sharing) and AFP (Mac sharing) Three common ways to share files using File Sharing are:\n                Apple File Protocol (AFP)AFP automatically uses encrypted logins, so this method of sharing files is fairly secure. The entire hard disk is shared to administrator user accounts. Individual home folders are shared to their respective user accounts. Users' \"Public\" folders (and the \"Drop Box\" folder inside) are shared to any user account that has sharing access to the computer (i.e. anyone in the \"staff\" group, including the guest account if it is enabled). Server Message Block (SMB), Common Internet File System (CIFS)When Windows (or possibly Linux) computers need to access file shared on a Mac, SMB/CIFS file sharing is commonly used. Apple warns that SMB sharing stores passwords is a less secure fashion than AFP sharing and anyone with system access can gain access to the password for that account. When sharing with SMB, each user that will access the Mac must have SMB enabled.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.4.8_Disable_File_Sharing\" do\n  title \"Disable File Sharing\"\n  desc  \"Apple's File Sharing uses a combination of SMB (Windows sharing) and AFP (Mac sharing) Three common ways to share files using File Sharing are:\\n                Apple File Protocol (AFP)AFP automatically uses encrypted logins, so this method of sharing files is fairly secure. The entire hard disk is shared to administrator user accounts. Individual home folders are shared to their respective user accounts. Users' \\\"Public\\\" folders (and the \\\"Drop Box\\\" folder inside) are shared to any user account that has sharing access to the computer (i.e. anyone in the \\\"staff\\\" group, including the guest account if it is enabled). Server Message Block (SMB), Common Internet File System (CIFS)When Windows (or possibly Linux) computers need to access file shared on a Mac, SMB/CIFS file sharing is commonly used. Apple warns that SMB sharing stores passwords is a less secure fashion than AFP sharing and anyone with system access can gain access to the password for that account. When sharing with SMB, each user that will access the Mac must have SMB enabled.\"\n  impact 1.0\n  describe bash(\"launchctl list | egrep '(nmdb|smdb|AppleFileServer)'\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"line":190,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command launchctl list | egrep '(nmdb|smdb|AppleFileServer)' stdout should not match /.+/","run_time":0.024553,"start_time":"2018-03-08T18:55:49+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.4.9_Disable_Remote_Management","title":"Disable Remote Management","desc":"Remote Management is the client portion of Apple Remote Desktop (ARD). Remote Management can be used by remote administrators to view the current Screen, install software, report on, and generally manage client Macs. The screen sharing options in Remote Management are identical to those in the Screen Sharing section. In fact, only one of the two can be configured. If Remote Management is used, refer to the Screen Sharing section above on issues regard screen sharing. Remote Management should only be enabled when a Directory is in place to manage the accounts with access. Computers will be available on port 5900 on an OS X System and could accept connections from untrusted hosts depending on the configuration, definitely a concern for mobile systems.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.4.9_Disable_Remote_Management\" do\n  title \"Disable Remote Management\"\n  desc  \"Remote Management is the client portion of Apple Remote Desktop (ARD). Remote Management can be used by remote administrators to view the current Screen, install software, report on, and generally manage client Macs. The screen sharing options in Remote Management are identical to those in the Screen Sharing section. In fact, only one of the two can be configured. If Remote Management is used, refer to the Screen Sharing section above on issues regard screen sharing. Remote Management should only be enabled when a Directory is in place to manage the accounts with access. Computers will be available on port 5900 on an OS X System and could accept connections from untrusted hosts depending on the configuration, definitely a concern for mobile systems.\"\n  impact 1.0\n  describe bash(\"ps -ef | egrep ARDAgent\") do\n    its(\"stdout\") { should_not match /\\/System\\/Library\\/CoreServices\\/RemoteManagement\\/ARDAgent.app\\/Contents\\/MacOS\\/ARDAgent$/ }\n  end\nend\n","source_location":{"line":199,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command ps -ef | egrep ARDAgent stdout should not match /\\/System\\/Library\\/CoreServices\\/RemoteManagement\\/ARDAgent.app\\/Contents\\/MacOS\\/ARDAgent$/","run_time":0.065559,"start_time":"2018-03-08T18:55:49+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.5.1_Disable_Wake_for_network_access","title":"Disable \"Wake for network access\"","desc":"This feature allows other users to be able to access your computer#x2019;s shared resources, such as shared printers or iTunes playlists, even when your computer is in sleep mode","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.5.1_Disable_Wake_for_network_access\" do\n  title \"Disable \\\"Wake for network access\\\"\"\n  desc  \"This feature allows other users to be able to access your computer#x2019;s shared resources, such as shared printers or iTunes playlists, even when your computer is in sleep mode\"\n  impact 1.0\n  describe bash(\"pmset -g | grep -i '^AC Power.*[^*]$' || pmset -g | egrep \\\"^\\\\s+womp\\\\s+0$\\\"\") do\n    its(\"exit_status\") { should eq 0 }\n  end\nend\n","source_location":{"line":208,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command pmset -g | grep -i '^AC Power.*[^*]$' || pmset -g | egrep \"^\\s+womp\\s+0$\" exit_status should eq 0","run_time":0.066862,"start_time":"2018-03-08T18:55:49+03:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.5.2_Disable_sleeping_the_computer_when_connected_to_power","title":"Disable sleeping the computer when connected to power","desc":"In some institutions certain software must be run that requires the computer to be awake. In these situations the computer should not be set to sleep. Not allowing the computer to sleep will use more power and increase the cost to operate the computer. This must be weighed against the needs of the organization.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.5.2_Disable_sleeping_the_computer_when_connected_to_power\" do\n  title \"Disable sleeping the computer when connected to power\"\n  desc  \"In some institutions certain software must be run that requires the computer to be awake. In these situations the computer should not be set to sleep. Not allowing the computer to sleep will use more power and increase the cost to operate the computer. This must be weighed against the needs of the organization.\"\n  impact 1.0\n  describe bash(\"pmset -g | grep -i '^AC Power.*[^*]$' || pmset -g | egrep \\\"^\\\\s*sleep\\\\s+0(\\\\s+.*)?$\\\"\") do\n    its(\"exit_status\") { should eq 0 }\n  end\nend\n","source_location":{"line":217,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command pmset -g | grep -i '^AC Power.*[^*]$' || pmset -g | egrep \"^\\s*sleep\\s+0(\\s+.*)?$\" exit_status should eq 0","run_time":0.055718,"start_time":"2018-03-08T18:55:49+03:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.6.1_Enable_FileVault","title":"Enable FileVault","desc":"FileVault secures a system's data by automatically encrypting its content and requiring a password or recovery key to access it.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.6.1_Enable_FileVault\" do\n  title \"Enable FileVault\"\n  desc  \"FileVault secures a system's data by automatically encrypting its content and requiring a password or recovery key to access it.\"\n  impact 1.0\n  describe bash(\"diskutil cs list | grep -i encryption\") do\n    its(\"stdout\") { should match /Encryption Status:\\s+Unlocked/ }\n  end\n  describe bash(\"diskutil cs list | grep -i encryption\") do\n    its(\"stdout\") { should match /Encryption Type:\\s*AES-XTS/ }\n  end\nend\n","source_location":{"line":226,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command diskutil cs list | grep -i encryption stdout should match /Encryption Status:\\s+Unlocked/","run_time":0.064708,"start_time":"2018-03-08T18:55:49+03:00","message":"expected \"\" to match /Encryption Status:\\s+Unlocked/\nDiff:\n@@ -1,2 +1,2 @@\n-/Encryption Status:\\s+Unlocked/\n+\"\"\n"},{"status":"failed","code_desc":"Bash command diskutil cs list | grep -i encryption stdout should match /Encryption Type:\\s*AES-XTS/","run_time":0.063534,"start_time":"2018-03-08T18:55:49+03:00","message":"expected \"\" to match /Encryption Type:\\s*AES-XTS/\nDiff:\n@@ -1,2 +1,2 @@\n-/Encryption Type:\\s*AES-XTS/\n+\"\"\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.6.2_Enable_Gatekeeper","title":"Enable Gatekeeper","desc":"Gatekeeper is Apple's application white-listing control that restricts downloaded applications from launching. It functions as a control to limit applications from unverified sources from running without authorization.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.6.2_Enable_Gatekeeper\" do\n  title \"Enable Gatekeeper\"\n  desc  \"Gatekeeper is Apple's application white-listing control that restricts downloaded applications from launching. It functions as a control to limit applications from unverified sources from running without authorization.\"\n  impact 1.0\n  describe bash(\"spctl --status\") do\n    its(\"stdout\") { should match /assessments\\s+enabled/ }\n  end\nend\n","source_location":{"line":238,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command spctl --status stdout should match /assessments\\s+enabled/","run_time":0.016485,"start_time":"2018-03-08T18:55:50+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.6.3_Enable_Firewall","title":"Enable Firewall","desc":"A firewall is a piece of software that blocks unwanted incoming connections to a system. Apple has posted general documentation about the application firewall.\n                http://support.apple.com/en-us/HT201642","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.6.3_Enable_Firewall\" do\n  title \"Enable Firewall\"\n  desc  \"A firewall is a piece of software that blocks unwanted incoming connections to a system. Apple has posted general documentation about the application firewall.\\n                http://support.apple.com/en-us/HT201642\"\n  impact 1.0\n  describe bash(\"defaults read /Library/Preferences/com.apple.alf globalstate \") do\n    its(\"stdout\") { should match /1|2/ }\n  end\nend\n","source_location":{"line":247,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command defaults read /Library/Preferences/com.apple.alf globalstate  stdout should match /1|2/","run_time":0.05185,"start_time":"2018-03-08T18:55:50+03:00","message":"expected \"0\\n\" to match /1|2/\nDiff:\n@@ -1,2 +1,2 @@\n-/1|2/\n+0\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.6.4_Enable_Firewall_Stealth_Mode","title":"Enable Firewall Stealth Mode","desc":"While in Stealth mode the computer will not respond to unsolicited probes, dropping that traffic.\n                http://support.apple.com/en-us/HT201642","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.6.4_Enable_Firewall_Stealth_Mode\" do\n  title \"Enable Firewall Stealth Mode\"\n  desc  \"While in Stealth mode the computer will not respond to unsolicited probes, dropping that traffic.\\n                http://support.apple.com/en-us/HT201642\"\n  impact 1.0\n  describe bash(\"defaults read /Library/Preferences/com.apple.alf globalstate \") do\n    its(\"stdout\") { should match /1/ }\n  end\nend\n","source_location":{"line":256,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command defaults read /Library/Preferences/com.apple.alf globalstate  stdout should match /1/","run_time":0.043202,"start_time":"2018-03-08T18:55:50+03:00","message":"expected \"0\\n\" to match /1/\nDiff:\n@@ -1,2 +1,2 @@\n-/1/\n+0\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.6.5_Review_Application_Firewall_Rules","title":"Review Application Firewall Rules","desc":"A firewall is a piece of software that blocks unwanted incoming connections to a system. Apple has posted general documentation about the application firewall.\n                http://support.apple.com/en-us/HT201642\n                A computer should have a limited number of applications open to incoming connectivity. This rule will check for whether there are more than 10 rules for inbound connections.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.6.5_Review_Application_Firewall_Rules\" do\n  title \"Review Application Firewall Rules\"\n  desc  \"A firewall is a piece of software that blocks unwanted incoming connections to a system. Apple has posted general documentation about the application firewall.\\n                http://support.apple.com/en-us/HT201642\\n                A computer should have a limited number of applications open to incoming connectivity. This rule will check for whether there are more than 10 rules for inbound connections.\"\n  impact 1.0\n  describe bash(\"defaults read /Library/Preferences/com.apple.alf globalstate \") do\n    its(\"stdout\") { should match /1/ }\n  end\n  describe bash(\"/usr/libexec/ApplicationFirewall/socketfilterfw --listapps\") do\n    its(\"stdout\") { should_not match /^ALF: total number of apps = [1-9][0-9]+/ }\n  end\nend\n","source_location":{"line":265,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command defaults read /Library/Preferences/com.apple.alf globalstate  stdout should match /1/","run_time":0.043264,"start_time":"2018-03-08T18:55:50+03:00","message":"expected \"0\\n\" to match /1/\nDiff:\n@@ -1,2 +1,2 @@\n-/1/\n+0\n"},{"status":"passed","code_desc":"Bash command /usr/libexec/ApplicationFirewall/socketfilterfw --listapps stdout should not match /^ALF: total number of apps = [1-9][0-9]+/","run_time":0.050388,"start_time":"2018-03-08T18:55:50+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.7.1_iCloud_configuration","title":"iCloud configuration","desc":"Apple's iCloud is a consumer oriented service that allows a user to store data as well as find, control and backup devices that are associated with their Apple ID (Apple account.) The use of iCloud on Enterprise devices should align with the acceptable use policy for devices that are managed as well as confidentiality requirements for data handled by the user. If iCloud is allowed the data that is copied to Apple servers will likely be duplicated on both personal as well as Enterprise devices. For many users the Enterprise email system may replace many of the available features in iCloud. If using either an Exchange or Google environment email, calendars, notes and contacts can sync to the official Enterprise repository and be available through multiple devices. Depending on workplace requirements it may not be appropriate to intermingle Enterprise and personal bookmarks, photos and documents. Since the service allows every device associated with the users ID to synchronize and have access to the cloud storage the concern is not just about having sensitive data on Apple's servers but having that same data on the phone of the teenage son or daughter of an employee. The remote connectivity of \"Back to My Mac\" relies on screen sharing that should already be turned off, if available the users Apple ID (personal?) can be used for remote access to the Enterprise computer rather than through Enterprise managed accounts. Apple's iCloud is just one of many cloud based solutions being used for data synchronization across multiple platforms and it should be controlled consistently with other cloud services in your environment. Work with your employees and configure the access to best enable data protection for you mission.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.7.1_iCloud_configuration\" do\n  title \"iCloud configuration\"\n  desc  \"Apple's iCloud is a consumer oriented service that allows a user to store data as well as find, control and backup devices that are associated with their Apple ID (Apple account.) The use of iCloud on Enterprise devices should align with the acceptable use policy for devices that are managed as well as confidentiality requirements for data handled by the user. If iCloud is allowed the data that is copied to Apple servers will likely be duplicated on both personal as well as Enterprise devices. For many users the Enterprise email system may replace many of the available features in iCloud. If using either an Exchange or Google environment email, calendars, notes and contacts can sync to the official Enterprise repository and be available through multiple devices. Depending on workplace requirements it may not be appropriate to intermingle Enterprise and personal bookmarks, photos and documents. Since the service allows every device associated with the users ID to synchronize and have access to the cloud storage the concern is not just about having sensitive data on Apple's servers but having that same data on the phone of the teenage son or daughter of an employee. The remote connectivity of \\\"Back to My Mac\\\" relies on screen sharing that should already be turned off, if available the users Apple ID (personal?) can be used for remote access to the Enterprise computer rather than through Enterprise managed accounts. Apple's iCloud is just one of many cloud based solutions being used for data synchronization across multiple platforms and it should be controlled consistently with other cloud services in your environment. Work with your employees and configure the access to best enable data protection for you mission.\"\n  impact 0.0\nend\n","source_location":{"line":277,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.7.2_iCloud_keychain","title":"iCloud keychain","desc":"The iCloud keychain is Apple's password manager that works with OS X and iOS. The capability allows users to store passwords in either iOS or OS X for use in Safari on both platforms and other iOS integrated applications. The most pervasive use is driven by iOS use rather than OS X. The passwords stored in an OS X keychain on an Enterprise managed computer could be stored in Apple's cloud and then be available on a personal computer using the same account. The stored passwords could be for organizational as well as personal accounts.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.7.2_iCloud_keychain\" do\n  title \"iCloud keychain\"\n  desc  \"The iCloud keychain is Apple's password manager that works with OS X and iOS. The capability allows users to store passwords in either iOS or OS X for use in Safari on both platforms and other iOS integrated applications. The most pervasive use is driven by iOS use rather than OS X. The passwords stored in an OS X keychain on an Enterprise managed computer could be stored in Apple's cloud and then be available on a personal computer using the same account. The stored passwords could be for organizational as well as personal accounts.\"\n  impact 0.0\nend\n","source_location":{"line":283,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.7.3_iCloud_Drive","title":"iCloud Drive","desc":"iCloud Drive is Apple's storage solution for applications on both OS X and iOS to use the same files that are resident in Apple's cloud storage. The iCloud Drive folder is available much like Dropbox or the Microsoft or Google solutions. One of the concerns in public cloud storage is that proprietary data may be inappropriately stored in an end user's personal repository. Organizations that need specific controls on information should ensure that this service is turned off or the user knows what information must be stored on services that are approved for storage","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.7.3_iCloud_Drive\" do\n  title \"iCloud Drive\"\n  desc  \"iCloud Drive is Apple's storage solution for applications on both OS X and iOS to use the same files that are resident in Apple's cloud storage. The iCloud Drive folder is available much like Dropbox or the Microsoft or Google solutions. One of the concerns in public cloud storage is that proprietary data may be inappropriately stored in an end user's personal repository. Organizations that need specific controls on information should ensure that this service is turned off or the user knows what information must be stored on services that are approved for storage\"\n  impact 0.0\n  describe bash(\"for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/.GlobalPreferences; if [ -e $PREF.plist ]; then echo \\\"Checking User:$i\\\"; defaults read $PREF | egrep -i 'NSDocumentSaveNewDocumentsToCloud'; fi; done\") do\n    its(\"stdout\") { should_not match /^\\s+NSDocumentSaveNewDocumentsToCloud\\s+=\\s+[^0]+;$/ }\n  end\nend\n","source_location":{"line":289,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/.GlobalPreferences; if [ -e $PREF.plist ]; then echo \"Checking User:$i\"; defaults read $PREF | egrep -i 'NSDocumentSaveNewDocumentsToCloud'; fi; done stdout should not match /^\\s+NSDocumentSaveNewDocumentsToCloud\\s+=\\s+[^0]+;$/","run_time":0.046193,"start_time":"2018-03-08T18:55:50+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.8_Pair_the_remote_control_infrared_receiver_if_enabled","title":"Pair the remote control infrared receiver if enabled","desc":"An infrared receiver is a piece of hardware that sends information from an infrared remote control to another device by receiving and decoding signals. If a remote is used with a computer, a specific remote, or \"pair\", can be set-up to work with the computer. This will allow only the paired remote to work on that computer. If a remote is needed the receiver should only be accessible by a paired device. Many models do not have infrared hardware. The audit check looks for the hardware first.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.8_Pair_the_remote_control_infrared_receiver_if_enabled\" do\n  title \"Pair the remote control infrared receiver if enabled\"\n  desc  \"An infrared receiver is a piece of hardware that sends information from an infrared remote control to another device by receiving and decoding signals. If a remote is used with a computer, a specific remote, or \\\"pair\\\", can be set-up to work with the computer. This will allow only the paired remote to work on that computer. If a remote is needed the receiver should only be accessible by a paired device. Many models do not have infrared hardware. The audit check looks for the hardware first.\"\n  impact 1.0\n  describe bash(\"system_profiler -detailLevel basic SPUSBDataType 2>/dev/null | egrep \\\"IR Receiver\\\"; if [ \\\"$?\\\" == 0 ]; then ENABLED=$(defaults read /Library/Preferences/com.apple.driver.AppleIRController DeviceEnabled); UIDFILTER=$(defaults read /Library/Preferences/com.apple.driver.AppleIRController UIDFilter); if [ $ENABLED == 1 ]; then if [ \\\"$UIDFILTER\\\" == \\\"none\\\" ]; then echo Enabled and Not Paired; else echo Enabled and Paired; fi; else echo Disabled; fi; else echo Disabled; fi\") do\n    its(\"stdout\") { should_not match /Enabled and Not Paired/ }\n  end\nend\n","source_location":{"line":298,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command system_profiler -detailLevel basic SPUSBDataType 2>/dev/null | egrep \"IR Receiver\"; if [ \"$?\" == 0 ]; then ENABLED=$(defaults read /Library/Preferences/com.apple.driver.AppleIRController DeviceEnabled); UIDFILTER=$(defaults read /Library/Preferences/com.apple.driver.AppleIRController UIDFilter); if [ $ENABLED == 1 ]; then if [ \"$UIDFILTER\" == \"none\" ]; then echo Enabled and Not Paired; else echo Enabled and Paired; fi; else echo Disabled; fi; else echo Disabled; fi stdout should not match /Enabled and Not Paired/","run_time":0.218576,"start_time":"2018-03-08T18:55:50+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.9_Enable_Secure_Keyboard_Entry_in_terminal.app","title":"Enable Secure Keyboard Entry in terminal.app","desc":"Secure Keyboard Entry prevents other applications on the system and/or network from detecting and recording what is typed into Terminal.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.9_Enable_Secure_Keyboard_Entry_in_terminal.app\" do\n  title \"Enable Secure Keyboard Entry in terminal.app\"\n  desc  \"Secure Keyboard Entry prevents other applications on the system and/or network from detecting and recording what is typed into Terminal.\"\n  impact 1.0\n  describe bash(\"for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/com.apple.Terminal; if [ -e $PREF.plist ]; then /bin/echo -n \\\"Checking User: '$i': \\\"; defaults read $PREF SecureKeyboardEntry 2>&1 | egrep '(Checking|^\\\\d$|not exist)'; fi; done\") do\n    its(\"stdout\") { should match /^Checking User: '.*': 1$/ }\n  end\nend\n","source_location":{"line":307,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/com.apple.Terminal; if [ -e $PREF.plist ]; then /bin/echo -n \"Checking User: '$i': \"; defaults read $PREF SecureKeyboardEntry 2>&1 | egrep '(Checking|^\\d$|not exist)'; fi; done stdout should match /^Checking User: '.*': 1$/","run_time":0.049939,"start_time":"2018-03-08T18:55:50+03:00","message":"expected \"Checking User: '/Users/mac': 0\\n\" to match /^Checking User: '.*': 1$/\nDiff:\n@@ -1,2 +1,2 @@\n-/^Checking User: '.*': 1$/\n+Checking User: '/Users/mac': 0\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.10_Java_6_is_not_the_default_Java_runtime","title":"Java 6 is not the default Java runtime","desc":"Apple had made Java part of the core Operating System for OS X. Apple is no longer providing Java updates for OS X and updated JREs and JDK are made available by Oracle. The latest version of Java 6 made available by Apple has many unpatched vulnerabilities and should not be the default runtime for Java applets that request one from the Operating System","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.10_Java_6_is_not_the_default_Java_runtime\" do\n  title \"Java 6 is not the default Java runtime\"\n  desc  \"Apple had made Java part of the core Operating System for OS X. Apple is no longer providing Java updates for OS X and updated JREs and JDK are made available by Oracle. The latest version of Java 6 made available by Apple has many unpatched vulnerabilities and should not be the default runtime for Java applets that request one from the Operating System\"\n  impact 1.0\n  describe bash(\"java -version 2>&1 | egrep -o '1\\\\.[456]\\\\.[^\\\"\\\\) ]+'\") do\n    its(\"stdout\") { should_not match /0/ }\n  end\nend\n","source_location":{"line":316,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command java -version 2>&1 | egrep -o '1\\.[456]\\.[^\"\\) ]+' stdout should not match /0/","run_time":0.334034,"start_time":"2018-03-08T18:55:50+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_2.11_Securely_delete_files_as_needed","title":"Securely delete files as needed","desc":"In previous versions of OS X Apple included a capability to securely empty the trash that included overwrites of the existing data. With the wider use of FileVault and other encryption methods and the growing use of Solid State Drives the requirements have changed and the \"Secure Empty Trash\" capability has been removed from the GUI. For systems that are not using encryption and continue to use platter-based hard drives there is still risk that deleted files can still be recovered from the file system. For additional protection in the removal of confidential files srm can be used form the command line. man srm","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.11_Securely_delete_files_as_needed\" do\n  title \"Securely delete files as needed\"\n  desc  \"In previous versions of OS X Apple included a capability to securely empty the trash that included overwrites of the existing data. With the wider use of FileVault and other encryption methods and the growing use of Solid State Drives the requirements have changed and the \\\"Secure Empty Trash\\\" capability has been removed from the GUI. For systems that are not using encryption and continue to use platter-based hard drives there is still risk that deleted files can still be recovered from the file system. For additional protection in the removal of confidential files srm can be used form the command line. man srm\"\n  impact 0.0\nend\n","source_location":{"line":325,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[]},{"id":"xccdf_org.cisecurity.benchmarks_rule_3.1.1_Retain_system.log_for_90_or_more_days","title":"Retain system.log for 90 or more days","desc":"OSX writes information pertaining to system-related events to the file /var/log/system.log and has a configurable retention policy for this file. The default logging setting limits the file size of the logs and the maximum size for all logs with it's own rule in asl.conf. The default allows for an errant application to fill the log files and does not enforce sufficient log retention. The Benchmark recommends a value based on standard use cases. The value should align with local requirements within the organization. The default value has an \"all_max\" file limitation, no reference to a minimum retention and a less precise rotation argument.\n                The maximum file size limitation string should be removed \"all_max=\" An organization appropriate retention should be added \"ttl=\" The rotation should be set with time stamps \"rotate=utc\" or \"rotate=local\"","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_3.1.1_Retain_system.log_for_90_or_more_days\" do\n  title \"Retain system.log for 90 or more days\"\n  desc  \"OSX writes information pertaining to system-related events to the file /var/log/system.log and has a configurable retention policy for this file. The default logging setting limits the file size of the logs and the maximum size for all logs with it's own rule in asl.conf. The default allows for an errant application to fill the log files and does not enforce sufficient log retention. The Benchmark recommends a value based on standard use cases. The value should align with local requirements within the organization. The default value has an \\\"all_max\\\" file limitation, no reference to a minimum retention and a less precise rotation argument.\\n                The maximum file size limitation string should be removed \\\"all_max=\\\" An organization appropriate retention should be added \\\"ttl=\\\" The rotation should be set with time stamps \\\"rotate=utc\\\" or \\\"rotate=local\\\"\"\n  impact 1.0\n  describe file(\"/etc/asl.conf\") do\n    its(\"content\") { should match /^> system.log [^#]* ttl=(9[0-9]|[1-9][0-9]{2,})(\\s.*)?$/ }\n  end\nend\n","source_location":{"line":331,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"File /etc/asl.conf content should match /^> system.log [^#]* ttl=(9[0-9]|[1-9][0-9]{2,})(\\s.*)?$/","run_time":0.001118,"start_time":"2018-03-08T18:55:50+03:00","message":"expected \"##\\n# configuration file for syslogd and aslmanager\\n##\\n\\n# aslmanager logs\\n> /var/log/asl/Logs/as...ppfirewall.log\\n? [= Facility com.apple.alf.logging] file appfirewall.log file_max=5M all_max=50M\\n\" to match /^> system.log [^#]* ttl=(9[0-9]|[1-9][0-9]{2,})(\\s.*)?$/\nDiff:\n@@ -1,2 +1,35 @@\n-/^> system.log [^#]* ttl=(9[0-9]|[1-9][0-9]{2,})(\\s.*)?$/\n+##\n+# configuration file for syslogd and aslmanager\n+##\n+\n+# aslmanager logs\n+> /var/log/asl/Logs/aslmanager external style=lcl-b ttl=2\n+\n+# authpriv messages are root/admin readable\n+? [= Facility authpriv] access 0 80\n+\n+# remoteauth critical, alert, and emergency messages are root/admin readable\n+? [= Facility remoteauth] [<= Level critical] access 0 80\n+\n+# broadcast emergency messages\n+? [= Level emergency] broadcast\n+\n+# save kernel [PID 0] and launchd [PID 1] messages\n+? [<= PID 1] store\n+\n+# ignore \"internal\" facility\n+? [= Facility internal] ignore\n+\n+# save everything from emergency to notice\n+? [<= Level notice] store\n+\n+# Rules for /var/log/system.log\n+> system.log mode=0640 format=bsd rotate=seq compress file_max=5M all_max=50M\n+? [= Sender kernel] file system.log\n+? [<= Level notice] file system.log\n+? [= Facility auth] [<= Level info] file system.log\n+? [= Facility authpriv] [<= Level info] file system.log\n+\n+# Facility com.apple.alf.logging gets saved in appfirewall.log\n+? [= Facility com.apple.alf.logging] file appfirewall.log file_max=5M all_max=50M\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_3.1.2_Retain_appfirewall.log_for_90_or_more_days","title":"Retain appfirewall.log for 90 or more days","desc":"OSX writes information pertaining to system-related events to the file /var/log/ appfirewall.log and has a configurable retention policy for this file. The default logging setting limits the file size of the logs and the maximum size for all logs with it's own rule in asl.conf. The default allows for an errant application to fill the log files and does not enforce sufficient log retention. The Benchmark recommends a value based on standard use cases. The value should align with local requirements within the organization. The default value has an \"all_max\" file limitation, no reference to a minimum retention and a less precise rotation argument.\n                The maximum file size limitation string should be removed \"all_max=\" An organization appropriate retention should be added \"ttl=\" The rotation should be set with time stamps \"rotate=utc\" or \"rotate=local\"","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_3.1.2_Retain_appfirewall.log_for_90_or_more_days\" do\n  title \"Retain appfirewall.log for 90 or more days\"\n  desc  \"OSX writes information pertaining to system-related events to the file /var/log/ appfirewall.log and has a configurable retention policy for this file. The default logging setting limits the file size of the logs and the maximum size for all logs with it's own rule in asl.conf. The default allows for an errant application to fill the log files and does not enforce sufficient log retention. The Benchmark recommends a value based on standard use cases. The value should align with local requirements within the organization. The default value has an \\\"all_max\\\" file limitation, no reference to a minimum retention and a less precise rotation argument.\\n                The maximum file size limitation string should be removed \\\"all_max=\\\" An organization appropriate retention should be added \\\"ttl=\\\" The rotation should be set with time stamps \\\"rotate=utc\\\" or \\\"rotate=local\\\"\"\n  impact 1.0\n  describe file(\"/etc/asl.conf\") do\n    its(\"content\") { should match /^>[^#]*\\s+appfirewall.log\\s+([^#]+\\s+)?ttl=(9[0-9]|[1-9][0-9]{2,})(\\s.*)?$/ }\n  end\nend\n","source_location":{"line":340,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"File /etc/asl.conf content should match /^>[^#]*\\s+appfirewall.log\\s+([^#]+\\s+)?ttl=(9[0-9]|[1-9][0-9]{2,})(\\s.*)?$/","run_time":0.000705,"start_time":"2018-03-08T18:55:50+03:00","message":"expected \"##\\n# configuration file for syslogd and aslmanager\\n##\\n\\n# aslmanager logs\\n> /var/log/asl/Logs/as...ppfirewall.log\\n? [= Facility com.apple.alf.logging] file appfirewall.log file_max=5M all_max=50M\\n\" to match /^>[^#]*\\s+appfirewall.log\\s+([^#]+\\s+)?ttl=(9[0-9]|[1-9][0-9]{2,})(\\s.*)?$/\nDiff:\n@@ -1,2 +1,35 @@\n-/^>[^#]*\\s+appfirewall.log\\s+([^#]+\\s+)?ttl=(9[0-9]|[1-9][0-9]{2,})(\\s.*)?$/\n+##\n+# configuration file for syslogd and aslmanager\n+##\n+\n+# aslmanager logs\n+> /var/log/asl/Logs/aslmanager external style=lcl-b ttl=2\n+\n+# authpriv messages are root/admin readable\n+? [= Facility authpriv] access 0 80\n+\n+# remoteauth critical, alert, and emergency messages are root/admin readable\n+? [= Facility remoteauth] [<= Level critical] access 0 80\n+\n+# broadcast emergency messages\n+? [= Level emergency] broadcast\n+\n+# save kernel [PID 0] and launchd [PID 1] messages\n+? [<= PID 1] store\n+\n+# ignore \"internal\" facility\n+? [= Facility internal] ignore\n+\n+# save everything from emergency to notice\n+? [<= Level notice] store\n+\n+# Rules for /var/log/system.log\n+> system.log mode=0640 format=bsd rotate=seq compress file_max=5M all_max=50M\n+? [= Sender kernel] file system.log\n+? [<= Level notice] file system.log\n+? [= Facility auth] [<= Level info] file system.log\n+? [= Facility authpriv] [<= Level info] file system.log\n+\n+# Facility com.apple.alf.logging gets saved in appfirewall.log\n+? [= Facility com.apple.alf.logging] file appfirewall.log file_max=5M all_max=50M\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_3.1.3_Retain_authd.log_for_90_or_more_days","title":"Retain authd.log for 90 or more days","desc":"OSX writes information pertaining to system-related events to the file /var/log/ authd.log and has a configurable retention policy for this file. The default logging setting limits the file size of the logs and the maximum size for all logs with it's own rule in asl.conf. The default allows for an errant application to fill the log files and does not enforce sufficient log retention. The Benchmark recommends a value based on standard use cases. The value should align with local requirements within the organization. The default value has an \"all_max\" file limitation, no reference to a minimum retention and a less precise rotation argument.\n                The maximum file size limitation string should be removed \"all_max=\" An organization appropriate retention should be added \"ttl=\" The rotation should be set with time stamps \"rotate=utc\" or \"rotate=local\"","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_3.1.3_Retain_authd.log_for_90_or_more_days\" do\n  title \"Retain authd.log for 90 or more days\"\n  desc  \"OSX writes information pertaining to system-related events to the file /var/log/ authd.log and has a configurable retention policy for this file. The default logging setting limits the file size of the logs and the maximum size for all logs with it's own rule in asl.conf. The default allows for an errant application to fill the log files and does not enforce sufficient log retention. The Benchmark recommends a value based on standard use cases. The value should align with local requirements within the organization. The default value has an \\\"all_max\\\" file limitation, no reference to a minimum retention and a less precise rotation argument.\\n                The maximum file size limitation string should be removed \\\"all_max=\\\" An organization appropriate retention should be added \\\"ttl=\\\" The rotation should be set with time stamps \\\"rotate=utc\\\" or \\\"rotate=local\\\"\"\n  impact 1.0\n  describe file(\"/etc/asl/com.apple.authd\") do\n    its(\"content\") { should match /^\\* file \\/var\\/log\\/authd.log [^#]* ttl=(9[0-9]|[1-9][0-9]{2,})(\\s.*)?$/ }\n  end\nend\n","source_location":{"line":349,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"File /etc/asl/com.apple.authd content should match /^\\* file \\/var\\/log\\/authd.log [^#]* ttl=(9[0-9]|[1-9][0-9]{2,})(\\s.*)?$/","run_time":0.001087,"start_time":"2018-03-08T18:55:50+03:00","message":"expected \"? [= Sender authd] claim only\\n* file /var/log/authd.log mode=0640 compress format=bsd rotate=seq file_max=5M all_max=20M\\n? [<= Level error] file /var/log/system.log\\n? [<= Level error] store\\n\" to match /^\\* file \\/var\\/log\\/authd.log [^#]* ttl=(9[0-9]|[1-9][0-9]{2,})(\\s.*)?$/\nDiff:\n@@ -1,2 +1,5 @@\n-/^\\* file \\/var\\/log\\/authd.log [^#]* ttl=(9[0-9]|[1-9][0-9]{2,})(\\s.*)?$/\n+? [= Sender authd] claim only\n+* file /var/log/authd.log mode=0640 compress format=bsd rotate=seq file_max=5M all_max=20M\n+? [<= Level error] file /var/log/system.log\n+? [<= Level error] store\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_3.2_Enable_security_auditing","title":"Enable security auditing","desc":"OSX's audit facility, auditd, receives notifications from the kernel when certain system calls, such as open, fork, and exit, are made. These notifications are captured and written to an audit log.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_3.2_Enable_security_auditing\" do\n  title \"Enable security auditing\"\n  desc  \"OSX's audit facility, auditd, receives notifications from the kernel when certain system calls, such as open, fork, and exit, are made. These notifications are captured and written to an audit log.\"\n  impact 1.0\n  describe bash(\"launchctl list | grep -i auditd \") do\n    its(\"stdout\") { should match /com.apple.auditd/ }\n  end\nend\n","source_location":{"line":358,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command launchctl list | grep -i auditd  stdout should match /com.apple.auditd/","run_time":0.025556,"start_time":"2018-03-08T18:55:50+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_3.3_Configure_Security_Auditing_Flags","title":"Configure Security Auditing Flags","desc":"Auditing is the capture and maintenance of information about security-related events.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_3.3_Configure_Security_Auditing_Flags\" do\n  title \"Configure Security Auditing Flags\"\n  desc  \"Auditing is the capture and maintenance of information about security-related events.\"\n  impact 1.0\n  describe file(\"/etc/security/audit_control\") do\n    its(\"content\") { should match /^flags:(\\S+,)?lo(,\\S+)?$/ }\n  end\n  describe file(\"/etc/security/audit_control\") do\n    its(\"content\") { should match /^flags:(\\S+,)?ad(,\\S+)?$/ }\n  end\n  describe file(\"/etc/security/audit_control\") do\n    its(\"content\") { should match /^flags:(\\S+,)?fd(,\\S+)?$/ }\n  end\n  describe file(\"/etc/security/audit_control\") do\n    its(\"content\") { should match /^flags:(\\S+,)?fm(,\\S+)?$/ }\n  end\n  describe file(\"/etc/security/audit_control\") do\n    its(\"content\") { should match /^flags:(\\S+,)?-all(,\\S+)?$/ }\n  end\nend\n","source_location":{"line":367,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"File /etc/security/audit_control content should match /^flags:(\\S+,)?lo(,\\S+)?$/","run_time":0.00043,"start_time":"2018-03-08T18:55:50+03:00"},{"status":"failed","code_desc":"File /etc/security/audit_control content should match /^flags:(\\S+,)?ad(,\\S+)?$/","run_time":0.000844,"start_time":"2018-03-08T18:55:50+03:00","message":"expected \"#\\n# $P4: //depot/projects/trustedbsd/openbsm/etc/audit_control#8 $\\n#\\ndir:/var/audit\\nflags:lo,aa\\...enticated,has_console_access\\nmember-set-sflags-mask:\\nmember-clear-sflags-mask:has_authenticated\\n\" to match /^flags:(\\S+,)?ad(,\\S+)?$/\nDiff:\n@@ -1,2 +1,15 @@\n-/^flags:(\\S+,)?ad(,\\S+)?$/\n+#\n+# $P4: //depot/projects/trustedbsd/openbsm/etc/audit_control#8 $\n+#\n+dir:/var/audit\n+flags:lo,aa\n+minfree:5\n+naflags:lo,aa\n+policy:cnt,argv\n+filesz:2M\n+expire-after:10M\n+superuser-set-sflags-mask:has_authenticated,has_console_access\n+superuser-clear-sflags-mask:has_authenticated,has_console_access\n+member-set-sflags-mask:\n+member-clear-sflags-mask:has_authenticated\n"},{"status":"failed","code_desc":"File /etc/security/audit_control content should match /^flags:(\\S+,)?fd(,\\S+)?$/","run_time":0.000597,"start_time":"2018-03-08T18:55:50+03:00","message":"expected \"#\\n# $P4: //depot/projects/trustedbsd/openbsm/etc/audit_control#8 $\\n#\\ndir:/var/audit\\nflags:lo,aa\\...enticated,has_console_access\\nmember-set-sflags-mask:\\nmember-clear-sflags-mask:has_authenticated\\n\" to match /^flags:(\\S+,)?fd(,\\S+)?$/\nDiff:\n@@ -1,2 +1,15 @@\n-/^flags:(\\S+,)?fd(,\\S+)?$/\n+#\n+# $P4: //depot/projects/trustedbsd/openbsm/etc/audit_control#8 $\n+#\n+dir:/var/audit\n+flags:lo,aa\n+minfree:5\n+naflags:lo,aa\n+policy:cnt,argv\n+filesz:2M\n+expire-after:10M\n+superuser-set-sflags-mask:has_authenticated,has_console_access\n+superuser-clear-sflags-mask:has_authenticated,has_console_access\n+member-set-sflags-mask:\n+member-clear-sflags-mask:has_authenticated\n"},{"status":"failed","code_desc":"File /etc/security/audit_control content should match /^flags:(\\S+,)?fm(,\\S+)?$/","run_time":0.000477,"start_time":"2018-03-08T18:55:50+03:00","message":"expected \"#\\n# $P4: //depot/projects/trustedbsd/openbsm/etc/audit_control#8 $\\n#\\ndir:/var/audit\\nflags:lo,aa\\...enticated,has_console_access\\nmember-set-sflags-mask:\\nmember-clear-sflags-mask:has_authenticated\\n\" to match /^flags:(\\S+,)?fm(,\\S+)?$/\nDiff:\n@@ -1,2 +1,15 @@\n-/^flags:(\\S+,)?fm(,\\S+)?$/\n+#\n+# $P4: //depot/projects/trustedbsd/openbsm/etc/audit_control#8 $\n+#\n+dir:/var/audit\n+flags:lo,aa\n+minfree:5\n+naflags:lo,aa\n+policy:cnt,argv\n+filesz:2M\n+expire-after:10M\n+superuser-set-sflags-mask:has_authenticated,has_console_access\n+superuser-clear-sflags-mask:has_authenticated,has_console_access\n+member-set-sflags-mask:\n+member-clear-sflags-mask:has_authenticated\n"},{"status":"failed","code_desc":"File /etc/security/audit_control content should match /^flags:(\\S+,)?-all(,\\S+)?$/","run_time":0.00056,"start_time":"2018-03-08T18:55:50+03:00","message":"expected \"#\\n# $P4: //depot/projects/trustedbsd/openbsm/etc/audit_control#8 $\\n#\\ndir:/var/audit\\nflags:lo,aa\\...enticated,has_console_access\\nmember-set-sflags-mask:\\nmember-clear-sflags-mask:has_authenticated\\n\" to match /^flags:(\\S+,)?-all(,\\S+)?$/\nDiff:\n@@ -1,2 +1,15 @@\n-/^flags:(\\S+,)?-all(,\\S+)?$/\n+#\n+# $P4: //depot/projects/trustedbsd/openbsm/etc/audit_control#8 $\n+#\n+dir:/var/audit\n+flags:lo,aa\n+minfree:5\n+naflags:lo,aa\n+policy:cnt,argv\n+filesz:2M\n+expire-after:10M\n+superuser-set-sflags-mask:has_authenticated,has_console_access\n+superuser-clear-sflags-mask:has_authenticated,has_console_access\n+member-set-sflags-mask:\n+member-clear-sflags-mask:has_authenticated\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_3.4_Enable_remote_logging_for_Desktops_on_trusted_networks","title":"Enable remote logging for Desktops on trusted networks","desc":"A log is a file that records the events that occur while an operating system and/or software is running. The built-in syslog capability in OS X runs over UDP without encryption. Broadcasting log unencrypted over the internet is not a good idea. While syslog may be acceptable on some internal trusted networks it is not a solution for mobile devices that hop between networks. Solutions for logging might include:\n             An encrypted tunnel that auto reconnects for each new network the laptop joins A third party logging daemon that encrypts the log transmission A local store and forward script that bundles the logs and sends periodically through an encrypted transmission (ssh) or when the device is connected to a trusted network","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_3.4_Enable_remote_logging_for_Desktops_on_trusted_networks\" do\n  title \"Enable remote logging for Desktops on trusted networks\"\n  desc  \"A log is a file that records the events that occur while an operating system and/or software is running. The built-in syslog capability in OS X runs over UDP without encryption. Broadcasting log unencrypted over the internet is not a good idea. While syslog may be acceptable on some internal trusted networks it is not a solution for mobile devices that hop between networks. Solutions for logging might include:\\n             An encrypted tunnel that auto reconnects for each new network the laptop joins A third party logging daemon that encrypts the log transmission A local store and forward script that bundles the logs and sends periodically through an encrypted transmission (ssh) or when the device is connected to a trusted network\"\n  impact 0.0\nend\n","source_location":{"line":388,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[]},{"id":"xccdf_org.cisecurity.benchmarks_rule_3.5_Retain_install.log_for_365_or_more_days","title":"Retain install.log for 365 or more days","desc":"OSX writes information pertaining to system-related events to the file /var/log/ install.log and has a configurable retention policy for this file. The default logging setting limits the file size of the logs and the maximum size for all logs. The default allows for an errant application to fill the log files and does not enforce sufficient log retention. The Benchmark recommends a value based on standard use cases. The value should align with local requirements within the organization. The default value has an \"all_max\" file limitation, no reference to a minimum retention and a less precise rotation argument.\n             The maximum file size limitation string should be removed \"all_max=\" An organization appropriate retention should be added \"ttl=\" The rotation should be set with time stamps \"rotate=utc\" or \"rotate=local\"","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_3.5_Retain_install.log_for_365_or_more_days\" do\n  title \"Retain install.log for 365 or more days\"\n  desc  \"OSX writes information pertaining to system-related events to the file /var/log/ install.log and has a configurable retention policy for this file. The default logging setting limits the file size of the logs and the maximum size for all logs. The default allows for an errant application to fill the log files and does not enforce sufficient log retention. The Benchmark recommends a value based on standard use cases. The value should align with local requirements within the organization. The default value has an \\\"all_max\\\" file limitation, no reference to a minimum retention and a less precise rotation argument.\\n             The maximum file size limitation string should be removed \\\"all_max=\\\" An organization appropriate retention should be added \\\"ttl=\\\" The rotation should be set with time stamps \\\"rotate=utc\\\" or \\\"rotate=local\\\"\"\n  impact 1.0\n  describe file(\"/etc/asl/com.apple.install\") do\n    its(\"content\") { should match /^\\* file \\/var\\/log\\/install.log [^#]* ttl=([1-9][0-9]{3,}|[4-9][0-9]{2}|3([7-9][0-9]|6[5-9]))(\\s.*)?$/ }\n  end\nend\n","source_location":{"line":394,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"File /etc/asl/com.apple.install content should match /^\\* file \\/var\\/log\\/install.log [^#]* ttl=([1-9][0-9]{3,}|[4-9][0-9]{2}|3([7-9][0-9]|6[5-9]))(\\s.*)?$/","run_time":0.000547,"start_time":"2018-03-08T18:55:50+03:00","message":"expected \"# install messages get saved only in /var/log/install.log\\n? [= Facility install] claim only\\n* file /var/log/install.log format='$((Time)(JZ)) $Host $(Sender)[$(PID)]: $Message'\\n\" to match /^\\* file \\/var\\/log\\/install.log [^#]* ttl=([1-9][0-9]{3,}|[4-9][0-9]{2}|3([7-9][0-9]|6[5-9]))(\\s.*)?$/\nDiff:\n@@ -1,2 +1,4 @@\n-/^\\* file \\/var\\/log\\/install.log [^#]* ttl=([1-9][0-9]{3,}|[4-9][0-9]{2}|3([7-9][0-9]|6[5-9]))(\\s.*)?$/\n+# install messages get saved only in /var/log/install.log\n+? [= Facility install] claim only\n+* file /var/log/install.log format='$((Time)(JZ)) $Host $(Sender)[$(PID)]: $Message'\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_4.1_Disable_Bonjour_advertising_service","title":"Disable Bonjour advertising service","desc":"Bonjour is an auto-discovery mechanism for TCP/IP devices which enumerate devices and services within a local subnet. DNS on Mac OS X is integrated with Bonjour and should not be turned off, but the Bonjour advertising service can be disabled.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_4.1_Disable_Bonjour_advertising_service\" do\n  title \"Disable Bonjour advertising service\"\n  desc  \"Bonjour is an auto-discovery mechanism for TCP/IP devices which enumerate devices and services within a local subnet. DNS on Mac OS X is integrated with Bonjour and should not be turned off, but the Bonjour advertising service can be disabled.\"\n  impact 1.0\n  describe bash(\"defaults read /Library/Preferences/com.apple.alf globalstate\") do\n    its(\"stdout\") { should match /\\s*[12]\\s*$/ }\n  end\nend\n","source_location":{"line":403,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command defaults read /Library/Preferences/com.apple.alf globalstate stdout should match /\\s*[12]\\s*$/","run_time":0.040753,"start_time":"2018-03-08T18:55:50+03:00","message":"expected \"0\\n\" to match /\\s*[12]\\s*$/\nDiff:\n@@ -1,2 +1,2 @@\n-/\\s*[12]\\s*$/\n+0\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_4.2_Enable_Show_Wi-Fi_status_in_menu_bar","title":"Enable \"Show Wi-Fi status in menu bar\"","desc":"The Wi-Fi status in the menu bar indicates if the system's wireless internet capabilities are enabled. If so, the system will scan for available wireless networks to connect to. At the time of this revision all computers Apple builds have wireless, that has not always been the case, This control only pertains to systems that have a wireless NIC. Operating systems running in a virtual environment may not score as expected either.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_4.2_Enable_Show_Wi-Fi_status_in_menu_bar\" do\n  title \"Enable \\\"Show Wi-Fi status in menu bar\\\"\"\n  desc  \"The Wi-Fi status in the menu bar indicates if the system's wireless internet capabilities are enabled. If so, the system will scan for available wireless networks to connect to. At the time of this revision all computers Apple builds have wireless, that has not always been the case, This control only pertains to systems that have a wireless NIC. Operating systems running in a virtual environment may not score as expected either.\"\n  impact 1.0\n  describe bash(\"networksetup -listallhardwareports | grep -i Wi-Fi && for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/com.apple.systemuiserver; if [ -e $PREF.plist ]; then /bin/echo -n \\\"Checking User: '$i': \\\"; defaults read $PREF menuExtras 2>&1 | grep AirPort.menu || echo 'Not Set'; fi; done\") do\n    its(\"stdout\") { should_not match /Not Set$/ }\n  end\nend\n","source_location":{"line":412,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command networksetup -listallhardwareports | grep -i Wi-Fi && for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/com.apple.systemuiserver; if [ -e $PREF.plist ]; then /bin/echo -n \"Checking User: '$i': \"; defaults read $PREF menuExtras 2>&1 | grep AirPort.menu || echo 'Not Set'; fi; done stdout should not match /Not Set$/","run_time":0.074673,"start_time":"2018-03-08T18:55:50+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_4.3_Create_network_specific_locations","title":"Create network specific locations","desc":"The network location feature of the Mac is very powerful tool to manage network security. By creating different network locations, a user can easily (and without administrative privileges) change the network settings on the Mac. By only using the network interfaces needed at any specific time, exposure to attackers is limited. A little understanding of how the Network System Preferences pane works is required.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_4.3_Create_network_specific_locations\" do\n  title \"Create network specific locations\"\n  desc  \"The network location feature of the Mac is very powerful tool to manage network security. By creating different network locations, a user can easily (and without administrative privileges) change the network settings on the Mac. By only using the network interfaces needed at any specific time, exposure to attackers is limited. A little understanding of how the Network System Preferences pane works is required.\"\n  impact 0.0\nend\n","source_location":{"line":421,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[]},{"id":"xccdf_org.cisecurity.benchmarks_rule_4.4_Ensure_http_server_is_not_running","title":"Ensure http server is not running","desc":"Mac OS X used to have a graphical front-end to the embedded Apache web server in the Operating System. Personal web sharing could be enabled to allow someone on another computer to download files or information from the user's computer. Personal web sharing from a user endpoint has long been considered questionable and Apple has removed that capability from the GUI. Apache however is still part of the Operating System and can be easily turned on to share files and provide remote connectivity to an end user computer. Web sharing should only be done through hardened web servers and appropriate cloud services.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_4.4_Ensure_http_server_is_not_running\" do\n  title \"Ensure http server is not running\"\n  desc  \"Mac OS X used to have a graphical front-end to the embedded Apache web server in the Operating System. Personal web sharing could be enabled to allow someone on another computer to download files or information from the user's computer. Personal web sharing from a user endpoint has long been considered questionable and Apple has removed that capability from the GUI. Apache however is still part of the Operating System and can be easily turned on to share files and provide remote connectivity to an end user computer. Web sharing should only be done through hardened web servers and appropriate cloud services.\"\n  impact 1.0\n  describe bash(\"ps -ef | grep -i httpd\") do\n    its(\"stdout\") { should_not match /\\/usr\\/sbin\\/httpd/ }\n  end\nend\n","source_location":{"line":427,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command ps -ef | grep -i httpd stdout should not match /\\/usr\\/sbin\\/httpd/","run_time":0.06359,"start_time":"2018-03-08T18:55:51+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_4.5_Ensure_ftp_server_is_not_running","title":"Ensure ftp server is not running","desc":"Mac OS X used to have a graphical front-end to the embedded ftp server in the Operating System. Ftp sharing could be enabled to allow someone on another computer to download files or information from the user's computer. Running an Ftp server from a user endpoint has long been considered questionable and Apple has removed that capability from the GUI. The Ftp server however is still part of the Operating System and can be easily turned on to share files and provide remote connectivity to an end user computer. Ftp servers meet a specialized need to distribute files without strong authentication and should only be done through hardened servers. Cloud services or other distribution methods should be considered","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_4.5_Ensure_ftp_server_is_not_running\" do\n  title \"Ensure ftp server is not running\"\n  desc  \"Mac OS X used to have a graphical front-end to the embedded ftp server in the Operating System. Ftp sharing could be enabled to allow someone on another computer to download files or information from the user's computer. Running an Ftp server from a user endpoint has long been considered questionable and Apple has removed that capability from the GUI. The Ftp server however is still part of the Operating System and can be easily turned on to share files and provide remote connectivity to an end user computer. Ftp servers meet a specialized need to distribute files without strong authentication and should only be done through hardened servers. Cloud services or other distribution methods should be considered\"\n  impact 1.0\n  describe bash(\"launchctl list | egrep ftp\") do\n    its(\"stdout\") { should_not match /com.apple.ftpd/ }\n  end\nend\n","source_location":{"line":436,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command launchctl list | egrep ftp stdout should not match /com.apple.ftpd/","run_time":0.026467,"start_time":"2018-03-08T18:55:51+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_4.6_Ensure_nfs_server_is_not_running","title":"Ensure nfs server is not running","desc":"Mac OS X can act an NFS fileserver. NFS sharing could be enabled to allow someone on another computer to mount shares and gain access to information from the user's computer. File sharing from a user endpoint has long been considered questionable and Apple has removed that capability from the GUI. NFSD is still part of the Operating System and can be easily turned on to export shares and provide remote connectivity to an end user computer.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_4.6_Ensure_nfs_server_is_not_running\" do\n  title \"Ensure nfs server is not running\"\n  desc  \"Mac OS X can act an NFS fileserver. NFS sharing could be enabled to allow someone on another computer to mount shares and gain access to information from the user's computer. File sharing from a user endpoint has long been considered questionable and Apple has removed that capability from the GUI. NFSD is still part of the Operating System and can be easily turned on to export shares and provide remote connectivity to an end user computer.\"\n  impact 1.0\n  describe bash(\"ps -ef | grep -i nfsd\") do\n    its(\"stdout\") { should_not match /\\/sbin\\/nfsd/ }\n  end\n  describe bash(\"stat -L /etc/exports > /dev/null\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"line":445,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command ps -ef | grep -i nfsd stdout should not match /\\/sbin\\/nfsd/","run_time":0.063128,"start_time":"2018-03-08T18:55:51+03:00"},{"status":"passed","code_desc":"Bash command stat -L /etc/exports > /dev/null exit_status should not eq 0","run_time":0.023714,"start_time":"2018-03-08T18:55:51+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_5.1.1_Secure_Home_Folders","title":"Secure Home Folders","desc":"By default OS X allows all valid users into the top level of every other users home folder, and restricts access to the Apple default folders within. Another user on the same system can see you have a \"Documents\" folder but cannot see inside it. This configuration does work for personal file sharing but can expose user files to standard accounts on the system. The best parallel for Enterprise environments is that everyone who has a Dropbox account can see everything that is at the top level but can't see your pictures, in the parallel with OS X they can see into every new Directory that is created because of the default permissions. Home folders should be restricted to access only by the user. Sharing should be used on dedicated servers or cloud instances that are managing access controls. Some environments may encounter problems if execute rights are removed as well as read and write. Either no access or execute only for group or others is acceptable","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.1.1_Secure_Home_Folders\" do\n  title \"Secure Home Folders\"\n  desc  \"By default OS X allows all valid users into the top level of every other users home folder, and restricts access to the Apple default folders within. Another user on the same system can see you have a \\\"Documents\\\" folder but cannot see inside it. This configuration does work for personal file sharing but can expose user files to standard accounts on the system. The best parallel for Enterprise environments is that everyone who has a Dropbox account can see everything that is at the top level but can't see your pictures, in the parallel with OS X they can see into every new Directory that is created because of the default permissions. Home folders should be restricted to access only by the user. Sharing should be used on dedicated servers or cloud instances that are managing access controls. Some environments may encounter problems if execute rights are removed as well as read and write. Either no access or execute only for group or others is acceptable\"\n  impact 1.0\n  describe bash(\"find /Users -type d ! -perm -1000 -maxdepth 1 -a -perm +0066 | egrep -v \\\"^/Users$\\\" \") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"line":457,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command find /Users -type d ! -perm -1000 -maxdepth 1 -a -perm +0066 | egrep -v \"^/Users$\"  stdout should not match /.+/","run_time":0.025863,"start_time":"2018-03-08T18:55:51+03:00","message":"expected \"/Users/mac\\n\" not to match /.+/\nDiff:\n@@ -1,2 +1,2 @@\n-/.+/\n+/Users/mac\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_5.1.2_Check_System_Wide_Applications_for_appropriate_permissions","title":"Check System Wide Applications for appropriate permissions","desc":"Applications in the System Applications Directory (/Applications) should be world executable since that is their reason to be on the system. They should not be world writable and allow any process or user to alter them for other processes or users to then execute modified versions","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.1.2_Check_System_Wide_Applications_for_appropriate_permissions\" do\n  title \"Check System Wide Applications for appropriate permissions\"\n  desc  \"Applications in the System Applications Directory (/Applications) should be world executable since that is their reason to be on the system. They should not be world writable and allow any process or user to alter them for other processes or users to then execute modified versions\"\n  impact 1.0\n  describe bash(\"find /Applications -iname \\\"*\\\\.app\\\" -type d -perm -2 -ls\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"line":466,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command find /Applications -iname \"*\\.app\" -type d -perm -2 -ls stdout should not match /.+/","run_time":18.463419,"start_time":"2018-03-08T18:55:51+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_5.1.3_Check_System_folder_for_world_writable_files","title":"Check System folder for world writable files","desc":"Software sometimes insists on being installed in the /System Directory and have inappropriate world writable permissions.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.1.3_Check_System_folder_for_world_writable_files\" do\n  title \"Check System folder for world writable files\"\n  desc  \"Software sometimes insists on being installed in the /System Directory and have inappropriate world writable permissions.\"\n  impact 1.0\n  describe bash(\"find /System -type d -perm -2 -ls\") do\n    its(\"stdout\") { should match /\\s\\/System\\/Library\\/User Template\\/.+\\/Public\\/Drop Box$/ }\n  end\nend\n","source_location":{"line":475,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command find /System -type d -perm -2 -ls stdout should match /\\s\\/System\\/Library\\/User Template\\/.+\\/Public\\/Drop Box$/","run_time":15.130912,"start_time":"2018-03-08T18:56:09+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_5.1.4_Check_Library_folder_for_world_writable_files","title":"Check Library folder for world writable files","desc":"Software sometimes insists on being installed in the /Library Directory and have inappropriate world writable permissions.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.1.4_Check_Library_folder_for_world_writable_files\" do\n  title \"Check Library folder for world writable files\"\n  desc  \"Software sometimes insists on being installed in the /Library Directory and have inappropriate world writable permissions.\"\n  impact 1.0\n  describe bash(\"find /Library -type d -perm -2 -ls\") do\n    its(\"stdout\") { should match /\\s\\/Library\\/Caches/ }\n  end\nend\n","source_location":{"line":484,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command find /Library -type d -perm -2 -ls stdout should match /\\s\\/Library\\/Caches/","run_time":6.191983,"start_time":"2018-03-08T18:56:24+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_5.2.1_Configure_account_lockout_threshold","title":"Configure account lockout threshold","desc":"The account lockout threshold  specifies the amount of times a user can enter a wrong password before a lockout will occur.\n                Ensure that a lockout threshold is part of the password policy on the computer","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.2.1_Configure_account_lockout_threshold\" do\n  title \"Configure account lockout threshold\"\n  desc  \"The account lockout threshold  specifies the amount of times a user can enter a wrong password before a lockout will occur.\\n                Ensure that a lockout threshold is part of the password policy on the computer\"\n  impact 1.0\n  describe bash(\"pwpolicy -getaccountpolicies | grep -A 1 '<key>policyAttributeMaximumFailedAuthentications</key>' | tail -1 | cut -d'>' -f2 | cut -d '<' -f1\") do\n    its(\"stdout\") { should cmp <= 5 }\n  end\nend\n","source_location":{"line":493,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command pwpolicy -getaccountpolicies | grep -A 1 '<key>policyAttributeMaximumFailedAuthentications</key>' | tail -1 | cut -d'>' -f2 | cut -d '<' -f1 stdout should cmp <= 5","run_time":0.052464,"start_time":"2018-03-08T18:56:31+03:00","message":"\nexpected it to be <= 5\n     got: \n\n(compared using `cmp` matcher)\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_5.2.2_Set_a_minimum_password_length","title":"Set a minimum password length","desc":"A minimum password length is the lowest amount of characters a password can contain to meet a system's requirements. \n                Ensure that a minimum of a 15 character password is part of the password policy on the computer.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.2.2_Set_a_minimum_password_length\" do\n  title \"Set a minimum password length\"\n  desc  \"A minimum password length is the lowest amount of characters a password can contain to meet a system's requirements. \\n                Ensure that a minimum of a 15 character password is part of the password policy on the computer.\"\n  impact 1.0\n  describe bash(\"pwpolicy -getaccountpolicies\") do\n    its(\"stdout\") { should match /<string>Password must be a minimum of (1[5-9]|[2-9][0-9]|[1-9][0-9]{2,}) characters in length<\\/string>/ }\n  end\nend\n","source_location":{"line":502,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command pwpolicy -getaccountpolicies stdout should match /<string>Password must be a minimum of (1[5-9]|[2-9][0-9]|[1-9][0-9]{2,}) characters in length<\\/string>/","run_time":0.04287,"start_time":"2018-03-08T18:56:31+03:00","message":"expected \"Getting global account policies\\n\" to match /<string>Password must be a minimum of (1[5-9]|[2-9][0-9]|[1-9][0-9]{2,}) characters in length<\\/string>/\nDiff:\n@@ -1,2 +1,2 @@\n-/<string>Password must be a minimum of (1[5-9]|[2-9][0-9]|[1-9][0-9]{2,}) characters in length<\\/string>/\n+Getting global account policies\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_5.2.3_Complex_passwords_must_contain_an_Alphabetic_Character","title":"Complex passwords must contain an Alphabetic Character","desc":"Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters.  Ensure that an Alphabetic character is part of the password policy on the computer","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.2.3_Complex_passwords_must_contain_an_Alphabetic_Character\" do\n  title \"Complex passwords must contain an Alphabetic Character\"\n  desc  \"Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters.  Ensure that an Alphabetic character is part of the password policy on the computer\"\n  impact 1.0\n  describe bash(\"pwpolicy -getaccountpolicies\") do\n    its(\"stdout\") { should match /<string>Password must have at least [1-9][0-9]* letters?<\\/string>/ }\n  end\nend\n","source_location":{"line":511,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command pwpolicy -getaccountpolicies stdout should match /<string>Password must have at least [1-9][0-9]* letters?<\\/string>/","run_time":0.042586,"start_time":"2018-03-08T18:56:31+03:00","message":"expected \"Getting global account policies\\n\" to match /<string>Password must have at least [1-9][0-9]* letters?<\\/string>/\nDiff:\n@@ -1,2 +1,2 @@\n-/<string>Password must have at least [1-9][0-9]* letters?<\\/string>/\n+Getting global account policies\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_5.2.4_Complex_passwords_must_contain_a_Numeric_Character","title":"Complex passwords must contain a Numeric Character","desc":"Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters.  Ensure that a number or numeric value is part of the password policy on the computer.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.2.4_Complex_passwords_must_contain_a_Numeric_Character\" do\n  title \"Complex passwords must contain a Numeric Character\"\n  desc  \"Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters.  Ensure that a number or numeric value is part of the password policy on the computer.\"\n  impact 1.0\n  describe bash(\"pwpolicy -getaccountpolicies\") do\n    its(\"stdout\") { should match /<string>Password must have at least [1-9][0-9]* numbers?<\\/string>/ }\n  end\nend\n","source_location":{"line":520,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command pwpolicy -getaccountpolicies stdout should match /<string>Password must have at least [1-9][0-9]* numbers?<\\/string>/","run_time":0.047901,"start_time":"2018-03-08T18:56:31+03:00","message":"expected \"Getting global account policies\\n\" to match /<string>Password must have at least [1-9][0-9]* numbers?<\\/string>/\nDiff:\n@@ -1,2 +1,2 @@\n-/<string>Password must have at least [1-9][0-9]* numbers?<\\/string>/\n+Getting global account policies\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_5.2.5_Complex_passwords_must_contain_a_Special_Character","title":"Complex passwords must contain a Special Character","desc":"Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters. Ensure that a special character is part of the password policy on the computer","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.2.5_Complex_passwords_must_contain_a_Special_Character\" do\n  title \"Complex passwords must contain a Special Character\"\n  desc  \"Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters. Ensure that a special character is part of the password policy on the computer\"\n  impact 1.0\n  describe bash(\"pwpolicy -getaccountpolicies\") do\n    its(\"stdout\") { should match /<string>Password must have at least [1-9][0-9]* special characters?<\\/string>/ }\n  end\nend\n","source_location":{"line":529,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command pwpolicy -getaccountpolicies stdout should match /<string>Password must have at least [1-9][0-9]* special characters?<\\/string>/","run_time":0.045931,"start_time":"2018-03-08T18:56:31+03:00","message":"expected \"Getting global account policies\\n\" to match /<string>Password must have at least [1-9][0-9]* special characters?<\\/string>/\nDiff:\n@@ -1,2 +1,2 @@\n-/<string>Password must have at least [1-9][0-9]* special characters?<\\/string>/\n+Getting global account policies\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_5.2.6_Complex_passwords_must_uppercase_and_lowercase_letters","title":"Complex passwords must uppercase and lowercase letters","desc":"Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters.  Ensure that both uppercase and lowercase letters are part of the password policy on the computer","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.2.6_Complex_passwords_must_uppercase_and_lowercase_letters\" do\n  title \"Complex passwords must uppercase and lowercase letters\"\n  desc  \"Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters.  Ensure that both uppercase and lowercase letters are part of the password policy on the computer\"\n  impact 1.0\n  describe bash(\"pwpolicy -getaccountpolicies\") do\n    its(\"stdout\") { should match /<string>Password must have both uppercase and lowercase letters<\\/string>/ }\n  end\nend\n","source_location":{"line":538,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command pwpolicy -getaccountpolicies stdout should match /<string>Password must have both uppercase and lowercase letters<\\/string>/","run_time":0.044277,"start_time":"2018-03-08T18:56:31+03:00","message":"expected \"Getting global account policies\\n\" to match /<string>Password must have both uppercase and lowercase letters<\\/string>/\nDiff:\n@@ -1,2 +1,2 @@\n-/<string>Password must have both uppercase and lowercase letters<\\/string>/\n+Getting global account policies\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_5.2.7_Password_Age","title":"Password Age","desc":"Over time passwords can be captured by third parties through mistakes, phishing attacks, third party breaches or merely brute force attacks. To reduce the risk of exposure and to decrease the incentives of password reuse (passwords that are not forced to be changed periodically generally are not ever changed) users must reset passwords periodically. This control uses 90 days as the acceptable value, some organizations may be more or less restrictive. Ensure that password rotation is part of the password policy on the computer.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.2.7_Password_Age\" do\n  title \"Password Age\"\n  desc  \"Over time passwords can be captured by third parties through mistakes, phishing attacks, third party breaches or merely brute force attacks. To reduce the risk of exposure and to decrease the incentives of password reuse (passwords that are not forced to be changed periodically generally are not ever changed) users must reset passwords periodically. This control uses 90 days as the acceptable value, some organizations may be more or less restrictive. Ensure that password rotation is part of the password policy on the computer.\"\n  impact 1.0\n  describe bash(\"pwpolicy -getaccountpolicies\") do\n    its(\"stdout\") { should match /<string>policyAttributeCurrentTime &gt; policyAttributeLastPasswordChangeTime \\+ policyAttributeExpiresEveryNDays \\* 24 \\* 60 \\* 60<\\/string>/ }\n  end\n  describe bash(\"pwpolicy -getaccountpolicies | grep -A 1 '<key>policyAttributeExpiresEveryNDays</key>' | tail -1 | cut -d'>' -f2 | cut -d '<' -f1\") do\n    its(\"stdout\") { should cmp <= 90 }\n  end\nend\n","source_location":{"line":547,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command pwpolicy -getaccountpolicies stdout should match /<string>policyAttributeCurrentTime &gt; policyAttributeLastPasswordChangeTime \\+ policyAttributeExpiresEveryNDays \\* 24 \\* 60 \\* 60<\\/string>/","run_time":0.044189,"start_time":"2018-03-08T18:56:31+03:00","message":"expected \"Getting global account policies\\n\" to match /<string>policyAttributeCurrentTime &gt; policyAttributeLastPasswordChangeTime \\+ policyAttributeExpiresEveryNDays \\* 24 \\* 60 \\* 60<\\/string>/\nDiff:\n@@ -1,2 +1,2 @@\n-/<string>policyAttributeCurrentTime &gt; policyAttributeLastPasswordChangeTime \\+ policyAttributeExpiresEveryNDays \\* 24 \\* 60 \\* 60<\\/string>/\n+Getting global account policies\n"},{"status":"failed","code_desc":"Bash command pwpolicy -getaccountpolicies | grep -A 1 '<key>policyAttributeExpiresEveryNDays</key>' | tail -1 | cut -d'>' -f2 | cut -d '<' -f1 stdout should cmp <= 90","run_time":0.037735,"start_time":"2018-03-08T18:56:31+03:00","message":"\nexpected it to be <= 90\n     got: \n\n(compared using `cmp` matcher)\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_5.2.8_Password_History","title":"Password History","desc":"Over time passwords can be captured by third parties through mistakes, phishing attacks, third party breaches or merely brute force attacks. To reduce the risk of exposure and to decrease the incentives of password reuse (passwords that are not forced to be changed periodically generally are not ever changed) users must reset passwords periodically. This control ensures that previous passwords are not reused immediately by keeping a history of previous passwords hashes. Ensure that password history checks are part of the password policy on the computer. This control checks whether a new password is different than the previous 15.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.2.8_Password_History\" do\n  title \"Password History\"\n  desc  \"Over time passwords can be captured by third parties through mistakes, phishing attacks, third party breaches or merely brute force attacks. To reduce the risk of exposure and to decrease the incentives of password reuse (passwords that are not forced to be changed periodically generally are not ever changed) users must reset passwords periodically. This control ensures that previous passwords are not reused immediately by keeping a history of previous passwords hashes. Ensure that password history checks are part of the password policy on the computer. This control checks whether a new password is different than the previous 15.\"\n  impact 1.0\n  describe bash(\"pwpolicy -getaccountpolicies\") do\n    its(\"stdout\") { should match /<string>Password must differ from past 15 passwords<\\/string>/ }\n  end\nend\n","source_location":{"line":559,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command pwpolicy -getaccountpolicies stdout should match /<string>Password must differ from past 15 passwords<\\/string>/","run_time":0.046538,"start_time":"2018-03-08T18:56:31+03:00","message":"expected \"Getting global account policies\\n\" to match /<string>Password must differ from past 15 passwords<\\/string>/\nDiff:\n@@ -1,2 +1,2 @@\n-/<string>Password must differ from past 15 passwords<\\/string>/\n+Getting global account policies\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_5.3_Reduce_the_sudo_timeout_period","title":"Reduce the sudo timeout period","desc":"The sudo command allows the user to run programs as the root user. Working as the root user allows the user an extremely high level of configurability within the system.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.3_Reduce_the_sudo_timeout_period\" do\n  title \"Reduce the sudo timeout period\"\n  desc  \"The sudo command allows the user to run programs as the root user. Working as the root user allows the user an extremely high level of configurability within the system.\"\n  impact 1.0\n  describe file(\"/etc/sudoers\") do\n    its(\"content\") { should match /^Defaults\\s+timestamp_timeout\\s*=\\s*0$/ }\n  end\nend\n","source_location":{"line":568,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"File /etc/sudoers content should match /^Defaults\\s+timestamp_timeout\\s*=\\s*0$/","run_time":0.001538,"start_time":"2018-03-08T18:56:31+03:00","message":"expected \"#\\n# Sample /etc/sudoers file.\\n#\\n# This file MUST be edited with the 'visudo' command as root.\\n#\\.../etc/sudoers.d\\n## (the '#' here does not indicate a comment)\\n#includedir /private/etc/sudoers.d\\n\" to match /^Defaults\\s+timestamp_timeout\\s*=\\s*0$/\nDiff:\n@@ -1,2 +1,61 @@\n-/^Defaults\\s+timestamp_timeout\\s*=\\s*0$/\n+#\n+# Sample /etc/sudoers file.\n+#\n+# This file MUST be edited with the 'visudo' command as root.\n+#\n+# See the sudoers man page for the details on how to write a sudoers file.\n+\n+##\n+# Override built-in defaults\n+##\n+Defaults\tenv_reset\n+Defaults\tenv_keep += \"BLOCKSIZE\"\n+Defaults\tenv_keep += \"COLORFGBG COLORTERM\"\n+Defaults\tenv_keep += \"__CF_USER_TEXT_ENCODING\"\n+Defaults\tenv_keep += \"CHARSET LANG LANGUAGE LC_ALL LC_COLLATE LC_CTYPE\"\n+Defaults\tenv_keep += \"LC_MESSAGES LC_MONETARY LC_NUMERIC LC_TIME\"\n+Defaults\tenv_keep += \"LINES COLUMNS\"\n+Defaults\tenv_keep += \"LSCOLORS\"\n+Defaults\tenv_keep += \"SSH_AUTH_SOCK\"\n+Defaults\tenv_keep += \"TZ\"\n+Defaults\tenv_keep += \"DISPLAY XAUTHORIZATION XAUTHORITY\"\n+Defaults\tenv_keep += \"EDITOR VISUAL\"\n+Defaults\tenv_keep += \"HOME MAIL\"\n+\n+Defaults\tlecture_file = \"/etc/sudo_lecture\"\n+\n+##\n+# User alias specification\n+##\n+# User_Alias\tFULLTIMERS = millert, mikef, dowdy\n+\n+##\n+# Runas alias specification\n+##\n+# Runas_Alias\tOP = root, operator\n+\n+##\n+# Host alias specification\n+##\n+# Host_Alias\tCUNETS = 128.138.0.0/255.255.0.0\n+# Host_Alias\tCSNETS = 128.138.243.0, 128.138.204.0/24, 128.138.242.0\n+# Host_Alias\tSERVERS = master, mail, www, ns\n+# Host_Alias\tCDROM = orion, perseus, hercules\n+\n+##\n+# Cmnd alias specification\n+##\n+# Cmnd_Alias\tPAGERS = /usr/bin/more, /usr/bin/pg, /usr/bin/less\n+\n+##\n+# User specification\n+##\n+\n+# root and users in group wheel can run anything on any machine as any user\n+root\t\tALL = (ALL) ALL\n+%admin\t\tALL = (ALL) ALL\n+\n+## Read drop-in files from /private/etc/sudoers.d\n+## (the '#' here does not indicate a comment)\n+#includedir /private/etc/sudoers.d\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_5.4_Automatically_lock_the_login_keychain_for_inactivity","title":"Automatically lock the login keychain for inactivity","desc":"The login keychain is a secure database store for passwords and certificates and is created for each user account on Mac OS X. The system software itself uses keychains for secure storage. Anyone with physical access to an unlocked keychain where the screen is also unlocked can copy all passwords in that keychain. Application access to the login keychain does not keep it unlocked. If you set Apple Mail to check for email every 10 minutes using the keychain for credentials and the keychain to lock every 15 minutes if inactive it will still cause the keychain to lock. The approach recommended here is that the login keychain be set to periodically lock when inactive to reduce the risk of password exposure or unauthorized use of credentials by a third party. The time period that an organization uses will depend on how great the use is of keychain aware applications. Organizations that use Firefox and Thunderbird will have a much different tolerance than those organization using keychain aware applications extensively.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.4_Automatically_lock_the_login_keychain_for_inactivity\" do\n  title \"Automatically lock the login keychain for inactivity\"\n  desc  \"The login keychain is a secure database store for passwords and certificates and is created for each user account on Mac OS X. The system software itself uses keychains for secure storage. Anyone with physical access to an unlocked keychain where the screen is also unlocked can copy all passwords in that keychain. Application access to the login keychain does not keep it unlocked. If you set Apple Mail to check for email every 10 minutes using the keychain for credentials and the keychain to lock every 15 minutes if inactive it will still cause the keychain to lock. The approach recommended here is that the login keychain be set to periodically lock when inactive to reduce the risk of password exposure or unauthorized use of credentials by a third party. The time period that an organization uses will depend on how great the use is of keychain aware applications. Organizations that use Firefox and Thunderbird will have a much different tolerance than those organization using keychain aware applications extensively.\"\n  impact 1.0\n  describe bash(\"security show-keychain-info 2>&1 | grep -o '[[:digit:]]\\\\+'\") do\n    its(\"stdout\") { should cmp <= 21600 }\n  end\nend\n","source_location":{"line":577,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command security show-keychain-info 2>&1 | grep -o '[[:digit:]]\\+' stdout should cmp <= 21600","run_time":0.064591,"start_time":"2018-03-08T18:56:31+03:00","message":"\nexpected it to be <= 21600\n     got: \n\n(compared using `cmp` matcher)\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_5.5_Ensure_login_keychain_is_locked_when_the_computer_sleeps","title":"Ensure login keychain is locked when the computer sleeps","desc":"The login keychain is a secure database store for passwords and certificates and is created for each user account on Mac OS X. The system software itself uses keychains for secure storage. Anyone with physical access to an unlocked keychain where the screen is also unlocked can copy all passwords in that keychain. The approach recommended here is that the login keychain be set to lock when when the computer sleeps to reduce the risk of password exposure.Organizations that use Firefox and Thunderbird will have a much different tolerance than those organization using keychain aware applications extensively.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.5_Ensure_login_keychain_is_locked_when_the_computer_sleeps\" do\n  title \"Ensure login keychain is locked when the computer sleeps\"\n  desc  \"The login keychain is a secure database store for passwords and certificates and is created for each user account on Mac OS X. The system software itself uses keychains for secure storage. Anyone with physical access to an unlocked keychain where the screen is also unlocked can copy all passwords in that keychain. The approach recommended here is that the login keychain be set to lock when when the computer sleeps to reduce the risk of password exposure.Organizations that use Firefox and Thunderbird will have a much different tolerance than those organization using keychain aware applications extensively.\"\n  impact 1.0\n  describe bash(\"security show-keychain-info 2>&1\") do\n    its(\"stdout\") { should match /lock\\-on\\-sleep/ }\n  end\nend\n","source_location":{"line":586,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command security show-keychain-info 2>&1 stdout should match /lock\\-on\\-sleep/","run_time":0.045926,"start_time":"2018-03-08T18:56:31+03:00","message":"expected \"Keychain \\\"<NULL>\\\" no-timeout\\n\" to match /lock\\-on\\-sleep/\nDiff:\n@@ -1,2 +1,2 @@\n-/lock\\-on\\-sleep/\n+Keychain \"<NULL>\" no-timeout\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_5.6_Enable_OCSP_and_CRL_certificate_checking","title":"Enable OCSP and CRL certificate checking","desc":"Certificates should only be trusted if they have both a satisfactory trust chain and they have not been revoked. OS X can check whether the certificate is still valid based on issued parameters within the certificate.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.6_Enable_OCSP_and_CRL_certificate_checking\" do\n  title \"Enable OCSP and CRL certificate checking\"\n  desc  \"Certificates should only be trusted if they have both a satisfactory trust chain and they have not been revoked. OS X can check whether the certificate is still valid based on issued parameters within the certificate.\"\n  impact 1.0\n  describe bash(\"defaults read com.apple.security.revocation CRLStyle\") do\n    its(\"stdout\") { should match /^RequireIfPresent$/ }\n  end\n  describe bash(\"defaults read com.apple.security.revocation OCSPStyle\") do\n    its(\"stdout\") { should match /^RequireIfPresent$/ }\n  end\nend\n","source_location":{"line":595,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command defaults read com.apple.security.revocation CRLStyle stdout should match /^RequireIfPresent$/","run_time":0.069365,"start_time":"2018-03-08T18:56:31+03:00","message":"expected \"\" to match /^RequireIfPresent$/\nDiff:\n@@ -1,2 +1,2 @@\n-/^RequireIfPresent$/\n+\"\"\n"},{"status":"failed","code_desc":"Bash command defaults read com.apple.security.revocation OCSPStyle stdout should match /^RequireIfPresent$/","run_time":0.044984,"start_time":"2018-03-08T18:56:31+03:00","message":"expected \"\" to match /^RequireIfPresent$/\nDiff:\n@@ -1,2 +1,2 @@\n-/^RequireIfPresent$/\n+\"\"\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_5.7_Do_not_enable_the_root_account","title":"Do not enable the \"root\" account","desc":"The root account is a superuser account that has access privileges to perform any actions and read/write to any file on the computer. In the UNIX/Linux world, the system administrator commonly uses the root account to perform administrative functions.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.7_Do_not_enable_the_root_account\" do\n  title \"Do not enable the \\\"root\\\" account\"\n  desc  \"The root account is a superuser account that has access privileges to perform any actions and read/write to any file on the computer. In the UNIX/Linux world, the system administrator commonly uses the root account to perform administrative functions.\"\n  impact 1.0\n  describe bash(\"dscl . -read /Users/root AuthenticationAuthority 2>&1\") do\n    its(\"stdout\") { should eq \"No such key: AuthenticationAuthority\" }\n  end\nend\n","source_location":{"line":607,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command dscl . -read /Users/root AuthenticationAuthority 2>&1 stdout should eq \"No such key: AuthenticationAuthority\"","run_time":0.062323,"start_time":"2018-03-08T18:56:31+03:00","message":"\nexpected: \"No such key: AuthenticationAuthority\"\n     got: \"No such key: AuthenticationAuthority\\n\"\n\n(compared using ==)\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_5.8_Disable_automatic_login","title":"Disable automatic login","desc":"The automatic login feature saves a user's system access credentials and bypasses the login screen, instead the system automatically loads to the user's desktop screen.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.8_Disable_automatic_login\" do\n  title \"Disable automatic login\"\n  desc  \"The automatic login feature saves a user's system access credentials and bypasses the login screen, instead the system automatically loads to the user's desktop screen.\"\n  impact 1.0\n  describe bash(\"defaults read /Library/Preferences/com.apple.loginwindow | grep autoLoginUser\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"line":616,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command defaults read /Library/Preferences/com.apple.loginwindow | grep autoLoginUser stdout should not match /.+/","run_time":0.036675,"start_time":"2018-03-08T18:56:31+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_5.9_Require_a_password_to_wake_the_computer_from_sleep_or_screen_saver","title":"Require a password to wake the computer from sleep or screen saver","desc":"Sleep and screensaver modes are low power modes that reduces electrical consumption while the system is not in use.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.9_Require_a_password_to_wake_the_computer_from_sleep_or_screen_saver\" do\n  title \"Require a password to wake the computer from sleep or screen saver\"\n  desc  \"Sleep and screensaver modes are low power modes that reduces electrical consumption while the system is not in use.\"\n  impact 1.0\n  describe bash(\"for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/com.apple.screensaver; if [ -e $PREF.plist ]; then /bin/echo -n \\\"Checking User: '$i': \\\"; defaults read $PREF askForPassword 2>&1 | egrep '(Checking|^\\\\d$|not exist)'; fi; done \") do\n    its(\"stdout\") { should match /^Checking User: '.+': 1$/ }\n  end\nend\n","source_location":{"line":625,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/com.apple.screensaver; if [ -e $PREF.plist ]; then /bin/echo -n \"Checking User: '$i': \"; defaults read $PREF askForPassword 2>&1 | egrep '(Checking|^\\d$|not exist)'; fi; done  stdout should match /^Checking User: '.+': 1$/","run_time":0.0488,"start_time":"2018-03-08T18:56:31+03:00","message":"expected \"Checking User: '/Users/mac': The domain/default pair of (/Users/mac/Library/Preferences/com.apple.screensaver, askForPassword) does not exist\\n\" to match /^Checking User: '.+': 1$/\nDiff:\n@@ -1,2 +1,2 @@\n-/^Checking User: '.+': 1$/\n+Checking User: '/Users/mac': The domain/default pair of (/Users/mac/Library/Preferences/com.apple.screensaver, askForPassword) does not exist\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_5.10_Require_an_administrator_password_to_access_system-wide_preferences","title":"Require an administrator password to access system-wide preferences","desc":"System Preferences controls system and user settings on an OS X Computer. System Preferences allows the user to tailor their experience on the computer as well as allowing the System Administrator to configure global security settings. Some of the settings should only be altered by the person responsible for the computer.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.10_Require_an_administrator_password_to_access_system-wide_preferences\" do\n  title \"Require an administrator password to access system-wide preferences\"\n  desc  \"System Preferences controls system and user settings on an OS X Computer. System Preferences allows the user to tailor their experience on the computer as well as allowing the System Administrator to configure global security settings. Some of the settings should only be altered by the person responsible for the computer.\"\n  impact 1.0\n  describe bash(\"security authorizationdb read system.preferences | grep \\\"<key>shared</key>\\\" -A1 \") do\n    its(\"stdout\") { should match /<false\\/>/ }\n  end\nend\n","source_location":{"line":634,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command security authorizationdb read system.preferences | grep \"<key>shared</key>\" -A1  stdout should match /<false\\/>/","run_time":0.051826,"start_time":"2018-03-08T18:56:31+03:00","message":"expected \"\\t<key>shared</key>\\n\\t<true/>\\n\" to match /<false\\/>/\nDiff:\n@@ -1,2 +1,3 @@\n-/<false\\/>/\n+\t<key>shared</key>\n+\t<true/>\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_5.11_Disable_ability_to_login_to_another_users_active_and_locked_session","title":"Disable ability to login to another user's active and locked session","desc":"OSX has a privilege that can be granted to any user that will allow that user to unlock active user's sessions.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.11_Disable_ability_to_login_to_another_users_active_and_locked_session\" do\n  title \"Disable ability to login to another user's active and locked session\"\n  desc  \"OSX has a privilege that can be granted to any user that will allow that user to unlock active user's sessions.\"\n  impact 1.0\n  describe bash(\"grep -i \\\"^account.*group=admin,wheel fail_safe\\\" /etc/pam.d/screensaver\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"line":643,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command grep -i \"^account.*group=admin,wheel fail_safe\" /etc/pam.d/screensaver stdout should not match /.+/","run_time":0.026353,"start_time":"2018-03-08T18:56:31+03:00","message":"expected \"account    required       pam_group.so no_warn group=admin,wheel fail_safe\\n\" not to match /.+/\nDiff:\n@@ -1,2 +1,2 @@\n-/.+/\n+account    required       pam_group.so no_warn group=admin,wheel fail_safe\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_5.12_Create_a_custom_message_for_the_Login_Screen","title":"Create a custom message for the Login Screen","desc":"An access warning informs the user that the system is reserved for authorized use only, and that the use of the system may be monitored.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.12_Create_a_custom_message_for_the_Login_Screen\" do\n  title \"Create a custom message for the Login Screen\"\n  desc  \"An access warning informs the user that the system is reserved for authorized use only, and that the use of the system may be monitored.\"\n  impact 1.0\n  describe bash(\"defaults read /Library/Preferences/com.apple.loginwindow.plist \") do\n    its(\"stdout\") { should match /LoginwindowText/ }\n  end\nend\n","source_location":{"line":652,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command defaults read /Library/Preferences/com.apple.loginwindow.plist  stdout should match /LoginwindowText/","run_time":0.047019,"start_time":"2018-03-08T18:56:31+03:00","message":"expected \"{\\n    GuestEnabled = 0;\\n    OptimizerLastRunForBuild = 35851456;\\n    OptimizerLastRunForSystem = 168624896;\\n    lastUser = loggedIn;\\n    lastUserName = mac;\\n}\\n\" to match /LoginwindowText/\nDiff:\n@@ -1,2 +1,8 @@\n-/LoginwindowText/\n+{\n+    GuestEnabled = 0;\n+    OptimizerLastRunForBuild = 35851456;\n+    OptimizerLastRunForSystem = 168624896;\n+    lastUser = loggedIn;\n+    lastUserName = mac;\n+}\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_5.13_Create_a_Login_window_banner","title":"Create a Login window banner","desc":"A Login window banner warning informs the user that the system is reserved for authorized use only. It enforces an acknowledgment by the user that they have been informed of the use policy in the banner if required","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.13_Create_a_Login_window_banner\" do\n  title \"Create a Login window banner\"\n  desc  \"A Login window banner warning informs the user that the system is reserved for authorized use only. It enforces an acknowledgment by the user that they have been informed of the use policy in the banner if required\"\n  impact 1.0\n  describe bash(\"ls /Library/Security/PolicyBanner.txt || ls /Library/Security/PolicyBanner.rtf || ls /Library/Security/PolicyBanner.rtfd\") do\n    its(\"exit_status\") { should eq 0 }\n  end\nend\n","source_location":{"line":661,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command ls /Library/Security/PolicyBanner.txt || ls /Library/Security/PolicyBanner.rtf || ls /Library/Security/PolicyBanner.rtfd exit_status should eq 0","run_time":0.033557,"start_time":"2018-03-08T18:56:31+03:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_5.14_Do_not_enter_a_password-related_hint","title":"Do not enter a password-related hint","desc":"Password hints help the user recall their passwords for various systems and/or accounts. In most cases, password hints are simple and closely related to the user's password.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.14_Do_not_enter_a_password-related_hint\" do\n  title \"Do not enter a password-related hint\"\n  desc  \"Password hints help the user recall their passwords for various systems and/or accounts. In most cases, password hints are simple and closely related to the user's password.\"\n  impact 0.0\nend\n","source_location":{"line":670,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[]},{"id":"xccdf_org.cisecurity.benchmarks_rule_5.15_Disable_Fast_User_Switching","title":"Disable Fast User Switching","desc":"Fast user switching allows a person to quickly log in to the computer with a different account. While only a minimal security risk, when a second user is logged in, that user might be able to see what processes the first user is using, or possibly gain other information about the first user. In a large directory environment where it is difficult to limit login access many valid users can login to other user's assigned computers.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.15_Disable_Fast_User_Switching\" do\n  title \"Disable Fast User Switching\"\n  desc  \"Fast user switching allows a person to quickly log in to the computer with a different account. While only a minimal security risk, when a second user is logged in, that user might be able to see what processes the first user is using, or possibly gain other information about the first user. In a large directory environment where it is difficult to limit login access many valid users can login to other user's assigned computers.\"\n  impact 0.0\nend\n","source_location":{"line":676,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[]},{"id":"xccdf_org.cisecurity.benchmarks_rule_5.16_Secure_individual_keychains_and_items","title":"Secure individual keychains and items","desc":"By default, the keychain for an account, especially a local account, have the same password as the account's logon password. It is possible to change the passwords on keychains to something different than the login password, and doing so would keep that keychain locked until needed after login. This is especially important when a smartcard is being used for console login. Keychains need to be protected by more than a pin in order to be secured and the default behavior with a smartcard will result in a pin for the login password. Individual keychain entries can have special ACLs to increase security as well.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.16_Secure_individual_keychains_and_items\" do\n  title \"Secure individual keychains and items\"\n  desc  \"By default, the keychain for an account, especially a local account, have the same password as the account's logon password. It is possible to change the passwords on keychains to something different than the login password, and doing so would keep that keychain locked until needed after login. This is especially important when a smartcard is being used for console login. Keychains need to be protected by more than a pin in order to be secured and the default behavior with a smartcard will result in a pin for the login password. Individual keychain entries can have special ACLs to increase security as well.\"\n  impact 0.0\nend\n","source_location":{"line":682,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[]},{"id":"xccdf_org.cisecurity.benchmarks_rule_5.17_Create_specialized_keychains_for_different_purposes","title":"Create specialized keychains for different purposes","desc":"The keychain is a secure database store for passwords and certificates and is created for each user account on Mac OS X. The system software itself uses keychains for secure storage. Users can create more than one keychain to protect various passwords separately.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.17_Create_specialized_keychains_for_different_purposes\" do\n  title \"Create specialized keychains for different purposes\"\n  desc  \"The keychain is a secure database store for passwords and certificates and is created for each user account on Mac OS X. The system software itself uses keychains for secure storage. Users can create more than one keychain to protect various passwords separately.\"\n  impact 0.0\nend\n","source_location":{"line":688,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[]},{"id":"xccdf_org.cisecurity.benchmarks_rule_5.18_System_Integrity_Protection_status","title":"System Integrity Protection status","desc":"System Integrity Protection is a new security feature introduced in OS X 10.11 El Capitan. System Integrity Protection restricts access to System domain locations and restricts runtime attachment to system processes. Any attempt to attempt to inspect or attach to a system process will fail. Kernel Extensions are now restricted to /Library/Extensions and are required to be signed with a Developer ID.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.18_System_Integrity_Protection_status\" do\n  title \"System Integrity Protection status\"\n  desc  \"System Integrity Protection is a new security feature introduced in OS X 10.11 El Capitan. System Integrity Protection restricts access to System domain locations and restricts runtime attachment to system processes. Any attempt to attempt to inspect or attach to a system process will fail. Kernel Extensions are now restricted to /Library/Extensions and are required to be signed with a Developer ID.\"\n  impact 1.0\nend\n","source_location":{"line":694,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[]},{"id":"xccdf_org.cisecurity.benchmarks_rule_5.19_Install_an_approved_tokend_for_smartcard_authentication_","title":"Install an approved tokend for smartcard authentication","desc":"US Federal government systems as well as many others are requiring the use of smartcards for user authentication. In order to enable this functionality for console authentication as well as authentication through the browser or VPN client a middleware package that contains a \"tokend\" is used on OS X. The opensource provided installers for OSW X are located here:\n             https://smartcardservices.macosforge.org/\n            \n             If your organization requires the use of a smartcard this control checks whether a tokend is in place. If your organization is not using smartcards or smartcard middleware that does not use tokend this control should not be scored.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.19_Install_an_approved_tokend_for_smartcard_authentication_\" do\n  title \"Install an approved tokend for smartcard authentication\"\n  desc  \"US Federal government systems as well as many others are requiring the use of smartcards for user authentication. In order to enable this functionality for console authentication as well as authentication through the browser or VPN client a middleware package that contains a \\\"tokend\\\" is used on OS X. The opensource provided installers for OSW X are located here:\\n             https://smartcardservices.macosforge.org/\\n            \\n             If your organization requires the use of a smartcard this control checks whether a tokend is in place. If your organization is not using smartcards or smartcard middleware that does not use tokend this control should not be scored.\"\n  impact 0.0\nend\n","source_location":{"line":700,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[]},{"id":"xccdf_org.cisecurity.benchmarks_rule_6.1.1_Display_login_window_as_name_and_password","title":"Display login window as name and password","desc":"The login window prompts a user for his/her credentials, verifies their authorization level and then allows or denies the user access to the system.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_6.1.1_Display_login_window_as_name_and_password\" do\n  title \"Display login window as name and password\"\n  desc  \"The login window prompts a user for his/her credentials, verifies their authorization level and then allows or denies the user access to the system.\"\n  impact 1.0\n  describe bash(\"defaults read /Library/Preferences/com.apple.loginwindow SHOWFULLNAME\") do\n    its(\"stdout\") { should eq \"1\" }\n  end\nend\n","source_location":{"line":706,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command defaults read /Library/Preferences/com.apple.loginwindow SHOWFULLNAME stdout should eq \"1\"","run_time":0.045056,"start_time":"2018-03-08T18:56:31+03:00","message":"\nexpected: \"1\"\n     got: \"\"\n\n(compared using ==)\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_6.1.2_Disable_Show_password_hints","title":"Disable \"Show password hints\"","desc":"Password hints are user created text displayed when an incorrect password is used for an account.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_6.1.2_Disable_Show_password_hints\" do\n  title \"Disable \\\"Show password hints\\\"\"\n  desc  \"Password hints are user created text displayed when an incorrect password is used for an account.\"\n  impact 1.0\n  describe bash(\"defaults read /Library/Preferences/com.apple.loginwindow RetriesUntilHint \") do\n    its(\"stdout\") { should eq \"0\" }\n  end\nend\n","source_location":{"line":715,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command defaults read /Library/Preferences/com.apple.loginwindow RetriesUntilHint  stdout should eq \"0\"","run_time":0.045785,"start_time":"2018-03-08T18:56:32+03:00","message":"\nexpected: \"0\"\n     got: \"\"\n\n(compared using ==)\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_6.1.3_Disable_guest_account_login","title":"Disable guest account login","desc":"The guest account allows users access to the system without having to create an account or password. Guest users are unable to make setting changes, cannot remotely login to the system and all created files, caches, and passwords are deleted upon logging out.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_6.1.3_Disable_guest_account_login\" do\n  title \"Disable guest account login\"\n  desc  \"The guest account allows users access to the system without having to create an account or password. Guest users are unable to make setting changes, cannot remotely login to the system and all created files, caches, and passwords are deleted upon logging out.\"\n  impact 1.0\n  describe bash(\"defaults read /Library/Preferences/com.apple.loginwindow.plist\") do\n    its(\"stdout\") { should_not match /GuestEnabled\\s*=\\s*1/ }\n  end\nend\n","source_location":{"line":724,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command defaults read /Library/Preferences/com.apple.loginwindow.plist stdout should not match /GuestEnabled\\s*=\\s*1/","run_time":0.046801,"start_time":"2018-03-08T18:56:32+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_6.1.4_Disable_Allow_guests_to_connect_to_shared_folders","title":"Disable \"Allow guests to connect to shared folders\"","desc":"Allowing guests to connect to shared folders enables users to access selected shared folders and their contents from different computers on a network.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_6.1.4_Disable_Allow_guests_to_connect_to_shared_folders\" do\n  title \"Disable \\\"Allow guests to connect to shared folders\\\"\"\n  desc  \"Allowing guests to connect to shared folders enables users to access selected shared folders and their contents from different computers on a network.\"\n  impact 1.0\n  describe bash(\"defaults read /Library/Preferences/com.apple.AppleFileServer\") do\n    its(\"stdout\") { should_not match /guestAccess\\s*=\\s*1/ }\n  end\nend\n","source_location":{"line":733,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command defaults read /Library/Preferences/com.apple.AppleFileServer stdout should not match /guestAccess\\s*=\\s*1/","run_time":0.050084,"start_time":"2018-03-08T18:56:32+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_6.2_Turn_on_filename_extensions","title":"Turn on filename extensions","desc":"A filename extension is a suffix added to a base filename that indicates the base filename's file format.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_6.2_Turn_on_filename_extensions\" do\n  title \"Turn on filename extensions\"\n  desc  \"A filename extension is a suffix added to a base filename that indicates the base filename's file format.\"\n  impact 1.0\n  describe bash(\"for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/.GlobalPreferences; if [ -e $PREF.plist ]; then /bin/echo -n \\\"Checking User: '$i': \\\"; defaults read $PREF AppleShowAllExtensions 2>&1 | egrep '(^\\\\d$|not exist)'; fi; done\") do\n    its(\"stdout\") { should match /1$/ }\n  end\nend\n","source_location":{"line":742,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"passed","code_desc":"Bash command for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/.GlobalPreferences; if [ -e $PREF.plist ]; then /bin/echo -n \"Checking User: '$i': \"; defaults read $PREF AppleShowAllExtensions 2>&1 | egrep '(^\\d$|not exist)'; fi; done stdout should match /1$/","run_time":0.050641,"start_time":"2018-03-08T18:56:32+03:00"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_6.3_Disable_the_automatic_run_of_safe_files_in_Safari","title":"Disable the automatic run of safe files in Safari","desc":"Safari will automatically run or execute what it considers safe files. This can include installers and other files that execute on the operating system. Safari bases files safety on the files type. The files considered safe include word files, PDF documents, and picture files.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_6.3_Disable_the_automatic_run_of_safe_files_in_Safari\" do\n  title \"Disable the automatic run of safe files in Safari\"\n  desc  \"Safari will automatically run or execute what it considers safe files. This can include installers and other files that execute on the operating system. Safari bases files safety on the files type. The files considered safe include word files, PDF documents, and picture files.\"\n  impact 1.0\n  describe bash(\"for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/com.apple.Safari; if [ -e $PREF.plist ]; then /bin/echo -n \\\"Checking User: '$i': \\\"; defaults read $PREF AutoOpenSafeDownloads 2>&1 | egrep '(^\\\\d$|not exist)'; fi; done \") do\n    its(\"stdout\") { should match /0$/ }\n  end\nend\n","source_location":{"line":751,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[{"status":"failed","code_desc":"Bash command for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/com.apple.Safari; if [ -e $PREF.plist ]; then /bin/echo -n \"Checking User: '$i': \"; defaults read $PREF AutoOpenSafeDownloads 2>&1 | egrep '(^\\d$|not exist)'; fi; done  stdout should match /0$/","run_time":0.050075,"start_time":"2018-03-08T18:56:32+03:00","message":"expected \"Checking User: '/Users/mac': The domain/default pair of (/Users/mac/Library/Preferences/com.apple.Safari, AutoOpenSafeDownloads) does not exist\\n\" to match /0$/\nDiff:\n@@ -1,2 +1,2 @@\n-/0$/\n+Checking User: '/Users/mac': The domain/default pair of (/Users/mac/Library/Preferences/com.apple.Safari, AutoOpenSafeDownloads) does not exist\n"}]},{"id":"xccdf_org.cisecurity.benchmarks_rule_6.4_Use_parental_controls_for_systems_that_are_not_centrally_managed","title":"Use parental controls for systems that are not centrally managed","desc":"Many aspects and features of OS X can be restricted on a user-by-user basis via the Parental Controls feature. This includes computer usage time limits, application accessibility limitations, and website restrictions. Although this feature is called Parental Controls, these restrictions may be appropriate for corporate, government, or educational use.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_6.4_Use_parental_controls_for_systems_that_are_not_centrally_managed\" do\n  title \"Use parental controls for systems that are not centrally managed\"\n  desc  \"Many aspects and features of OS X can be restricted on a user-by-user basis via the Parental Controls feature. This includes computer usage time limits, application accessibility limitations, and website restrictions. Although this feature is called Parental Controls, these restrictions may be appropriate for corporate, government, or educational use.\"\n  impact 0.0\nend\n","source_location":{"line":760,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[]},{"id":"xccdf_org.cisecurity.benchmarks_rule_7.1_Wireless_technology_on_OS_X","title":"Wireless technology on OS X","desc":"Some organizations have comprehensive rules that cover the use of wireless technologies in order to implement operational security. There are specific policies governing the use of both Bluetooth and Wi-Fi (802.11) that often include disabling the wireless capability in either software or hardware or both. Wireless access is part of the feature set required for mobile computers and is considered essential for most users. The general use case for OS X is to use wireless connectivity, Apple provides a wireless network card and Bluetooth capability in almost every product they make. Bluetooth keyboards are now the default selection where a keyboard is not already integrated into the device.\n              There are instructions on  how to remove parts of the operating system in order to remediate wireless connectivity but they are not recommended within the scope of this Benchmark.\n              https://apple.stackexchange.com/questions/99686/how-to-easily-and-completely-disable-enable-wlan-so-it-cannot-be-turned-on-agai https://apple.stackexchange.com/questions/123326/disable-bluetooth-permanently Mac OS X 10.11 computers will not allow this if System Integrity Protection is enabled.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.1_Wireless_technology_on_OS_X\" do\n  title \"Wireless technology on OS X\"\n  desc  \"Some organizations have comprehensive rules that cover the use of wireless technologies in order to implement operational security. There are specific policies governing the use of both Bluetooth and Wi-Fi (802.11) that often include disabling the wireless capability in either software or hardware or both. Wireless access is part of the feature set required for mobile computers and is considered essential for most users. The general use case for OS X is to use wireless connectivity, Apple provides a wireless network card and Bluetooth capability in almost every product they make. Bluetooth keyboards are now the default selection where a keyboard is not already integrated into the device.\\n              There are instructions on  how to remove parts of the operating system in order to remediate wireless connectivity but they are not recommended within the scope of this Benchmark.\\n              https://apple.stackexchange.com/questions/99686/how-to-easily-and-completely-disable-enable-wlan-so-it-cannot-be-turned-on-agai https://apple.stackexchange.com/questions/123326/disable-bluetooth-permanently Mac OS X 10.11 computers will not allow this if System Integrity Protection is enabled.\"\n  impact 0.0\nend\n","source_location":{"line":766,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[]},{"id":"xccdf_org.cisecurity.benchmarks_rule_7.2_iSight_Camera_Privacy_and_Confidentiality_Concerns","title":"iSight Camera Privacy and Confidentiality Concerns","desc":"If the computer is present in an area where there are privacy concerns or sensitive images or actions are taking place the camera should be covered at those times. A permanent cover or alteration may be required when the computer is always located in a confidential area. Malware is continuously discovered that circumvents the privacy controls of the built-in camera. No computer has perfect security and it seems likely that even if all the drivers are disabled or removed that working drivers can be re-introduced by a determined attacker. At this point video chatting and other uses of the built-in camera are standard uses for a computer. It is contrary to a standard use case to permanently remove the camera. In cases where the camera is not allowed to be used at all or when the computer is located in private areas additional precautions are warranted. The General rule should be that if the camera can capture images that could cause embarrassment or an adverse impact the camera should be covered until it is appropriate to use.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.2_iSight_Camera_Privacy_and_Confidentiality_Concerns\" do\n  title \"iSight Camera Privacy and Confidentiality Concerns\"\n  desc  \"If the computer is present in an area where there are privacy concerns or sensitive images or actions are taking place the camera should be covered at those times. A permanent cover or alteration may be required when the computer is always located in a confidential area. Malware is continuously discovered that circumvents the privacy controls of the built-in camera. No computer has perfect security and it seems likely that even if all the drivers are disabled or removed that working drivers can be re-introduced by a determined attacker. At this point video chatting and other uses of the built-in camera are standard uses for a computer. It is contrary to a standard use case to permanently remove the camera. In cases where the camera is not allowed to be used at all or when the computer is located in private areas additional precautions are warranted. The General rule should be that if the camera can capture images that could cause embarrassment or an adverse impact the camera should be covered until it is appropriate to use.\"\n  impact 0.0\nend\n","source_location":{"line":772,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[]},{"id":"xccdf_org.cisecurity.benchmarks_rule_7.3_Computer_Name_Considerations","title":"Computer Name Considerations","desc":"If the computer is used in an organization that assigns host names, it is a good idea to change the computer name to the host name. This is more of a best practice than a security measure. If the host name and the computer name are the same, computer support may be able to track problems down more easily. With mobile devices using DHCP IP tracking has serious drawbacks, hostname or computer name tracking makes much more sense for those organizations that can implement it. If the computer is using different names for the \"Computer Name\" DNS and Directory environments it can be difficult to manage Macs in an Enterprise asset inventory.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.3_Computer_Name_Considerations\" do\n  title \"Computer Name Considerations\"\n  desc  \"If the computer is used in an organization that assigns host names, it is a good idea to change the computer name to the host name. This is more of a best practice than a security measure. If the host name and the computer name are the same, computer support may be able to track problems down more easily. With mobile devices using DHCP IP tracking has serious drawbacks, hostname or computer name tracking makes much more sense for those organizations that can implement it. If the computer is using different names for the \\\"Computer Name\\\" DNS and Directory environments it can be difficult to manage Macs in an Enterprise asset inventory.\"\n  impact 0.0\nend\n","source_location":{"line":778,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[]},{"id":"xccdf_org.cisecurity.benchmarks_rule_7.4_Software_Inventory_Considerations","title":"Software Inventory Considerations","desc":"With the introduction of Mac OS X 10.6.6, Apple added a new application, App Store, which resides in the Applications directory. This application allows a user with admin privileges and an Apple ID to browse Apple's online App Store, purchase (including no cost purchases), and install new applications, bypassing corporate software inventory controls. Any admin user can install software in the /Applications directory whether from internet downloads, thumb drives, optical media, cloud storage or even binaries through email. Even standard users can run executables if permitted. The source of the software is not nearly as important as a consistent audit of all installed software for patch compliance and appropriateness. A single user desktop where the user, administrator and the person approving software are all the same person probably does not need to audit software inventory to this extent. It is helpful in the case of stability problems or malware however. Scan systems on a monthly basis and determine the number of unauthorized pieces of software that are installed. Verify that if an unauthorized piece of software is found one month, it is removed from the system the next. Export Apple System Profiler information through the built-in or other third party tools on an organizationally defined timetable.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.4_Software_Inventory_Considerations\" do\n  title \"Software Inventory Considerations\"\n  desc  \"With the introduction of Mac OS X 10.6.6, Apple added a new application, App Store, which resides in the Applications directory. This application allows a user with admin privileges and an Apple ID to browse Apple's online App Store, purchase (including no cost purchases), and install new applications, bypassing corporate software inventory controls. Any admin user can install software in the /Applications directory whether from internet downloads, thumb drives, optical media, cloud storage or even binaries through email. Even standard users can run executables if permitted. The source of the software is not nearly as important as a consistent audit of all installed software for patch compliance and appropriateness. A single user desktop where the user, administrator and the person approving software are all the same person probably does not need to audit software inventory to this extent. It is helpful in the case of stability problems or malware however. Scan systems on a monthly basis and determine the number of unauthorized pieces of software that are installed. Verify that if an unauthorized piece of software is found one month, it is removed from the system the next. Export Apple System Profiler information through the built-in or other third party tools on an organizationally defined timetable.\"\n  impact 0.0\nend\n","source_location":{"line":784,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[]},{"id":"xccdf_org.cisecurity.benchmarks_rule_7.5_Firewall_Consideration","title":"Firewall Consideration","desc":"In addition to the Application Layer Firewall (alf) mentioned in the benchmark, OSX also ships with packet filter, or pf. Leveraging pf is beyond the scope of this Benchmark. For more information, please see:\n             https://support.apple.com/kb/ht5519 http://blog.scottlowe.org/2013/05/15/using-pf-on-os-x-mountain-lion/","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.5_Firewall_Consideration\" do\n  title \"Firewall Consideration\"\n  desc  \"In addition to the Application Layer Firewall (alf) mentioned in the benchmark, OSX also ships with packet filter, or pf. Leveraging pf is beyond the scope of this Benchmark. For more information, please see:\\n             https://support.apple.com/kb/ht5519 http://blog.scottlowe.org/2013/05/15/using-pf-on-os-x-mountain-lion/\"\n  impact 0.0\nend\n","source_location":{"line":790,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[]},{"id":"xccdf_org.cisecurity.benchmarks_rule_7.6_Automatic_Actions_for_Optical_Media","title":"Automatic Actions for Optical Media","desc":"Managing automatic actions, while useful in very few situations, is unlikely to increase security on the computer and does complicate the users experience and add additional complexity to the configuration. These settings are user controlled and can be changed without Administrator privileges unless controlled through MCX settings or Parental Controls. Unlike Windows Auto-run the optical media is accessed through Operating System applications, those same applications can open and access the media directly. If optical media is not allowed in the environment the optical media drive should be disabled in hardware and software","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.6_Automatic_Actions_for_Optical_Media\" do\n  title \"Automatic Actions for Optical Media\"\n  desc  \"Managing automatic actions, while useful in very few situations, is unlikely to increase security on the computer and does complicate the users experience and add additional complexity to the configuration. These settings are user controlled and can be changed without Administrator privileges unless controlled through MCX settings or Parental Controls. Unlike Windows Auto-run the optical media is accessed through Operating System applications, those same applications can open and access the media directly. If optical media is not allowed in the environment the optical media drive should be disabled in hardware and software\"\n  impact 0.0\nend\n","source_location":{"line":796,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[]},{"id":"xccdf_org.cisecurity.benchmarks_rule_7.7_App_Store_Automatically_download_apps_purchased_on_other_Macs_Considerations","title":"App Store Automatically download apps purchased on other Macs Considerations","desc":"With 10.9 Apple has expanded the capability of the App Store to automatically download OS X applications that were purchased in the App Store on another Mac. This feature can be very desirable for personal Macs or in a small business setting so that all purchased software through Apple's App Store is provisioned on all OS X Computers, just like iOS. This feature may not be desirable in Corporate environments where the expectations of handling software licenses, tracking software inventory and personal software are different.\n              Please evaluate your organizations expectations about the use of personal software and software license tracking to align with this setting. For those organizations that are using Enterprise Apple IDs for their employees the reverse is true. If the user has the username and password for their Apple ID and software is being purchased on that account the user could download the software on other computers they have access to.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.7_App_Store_Automatically_download_apps_purchased_on_other_Macs_Considerations\" do\n  title \"App Store Automatically download apps purchased on other Macs Considerations\"\n  desc  \"With 10.9 Apple has expanded the capability of the App Store to automatically download OS X applications that were purchased in the App Store on another Mac. This feature can be very desirable for personal Macs or in a small business setting so that all purchased software through Apple's App Store is provisioned on all OS X Computers, just like iOS. This feature may not be desirable in Corporate environments where the expectations of handling software licenses, tracking software inventory and personal software are different.\\n              Please evaluate your organizations expectations about the use of personal software and software license tracking to align with this setting. For those organizations that are using Enterprise Apple IDs for their employees the reverse is true. If the user has the username and password for their Apple ID and software is being purchased on that account the user could download the software on other computers they have access to.\"\n  impact 0.0\nend\n","source_location":{"line":802,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[]},{"id":"xccdf_org.cisecurity.benchmarks_rule_7.8_Extensible_Firmware_Interface_EFI_password","title":"Extensible Firmware Interface (EFI) password","desc":"EFI is the software link between the motherboard hardware and the software operating system. EFI determines which partition or disk to load Mac OS X from, it also determines whether the user can enter single-user mode. The main reasons to set a firmware password have been protections against an alternative boot disk, protection against a passwordless root shell through single user mode and protection against firewire DMA attacks. In the past it was not difficult to reset the firmware password by removing RAM but it did make tampering slightly harder and having to remove RAM remediated memory scraping attacks through DMA. It has always been difficult to Manage the firmware password on OS X computers, though some tools did make it much easier. Apple patched OS X in 10.7 to mitigate the DMA attacks and the use of FileVault 2 Full-Disk Encryption mitigates the risk of damage to the boot volume if an unauthorized user uses a different boot volume or uses Single User Mode. Apple's reliance on the recovery partition and the additional features it provides make controls that do not allow the user to boot into the recovery partition less attractive. Starting in Late 2010 with the MacBook Air Apple has slowly updated the requirements to recover from a lost firmware password. Apple only supports taking the computer to an Apple authorized service provider. This change makes managing the firmware password well if used more critical. Setting the firmware password may be good practice in some environments. We cannot recommend it as a standard security practice at this time. http://support.apple.com/kb/ts3554 https://jamfnation.jamfsoftware.com/article.html?id=58 http://derflounder.wordpress.com/2012/02/05/protecting-yourself-against-firewire-dma-attacks-on-10-7-x/ http://derflounder.wordpress.com/2013/04/26/booting-into-single-user-mode-on-a-filevault-2-encrypted-mac/","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.8_Extensible_Firmware_Interface_EFI_password\" do\n  title \"Extensible Firmware Interface (EFI) password\"\n  desc  \"EFI is the software link between the motherboard hardware and the software operating system. EFI determines which partition or disk to load Mac OS X from, it also determines whether the user can enter single-user mode. The main reasons to set a firmware password have been protections against an alternative boot disk, protection against a passwordless root shell through single user mode and protection against firewire DMA attacks. In the past it was not difficult to reset the firmware password by removing RAM but it did make tampering slightly harder and having to remove RAM remediated memory scraping attacks through DMA. It has always been difficult to Manage the firmware password on OS X computers, though some tools did make it much easier. Apple patched OS X in 10.7 to mitigate the DMA attacks and the use of FileVault 2 Full-Disk Encryption mitigates the risk of damage to the boot volume if an unauthorized user uses a different boot volume or uses Single User Mode. Apple's reliance on the recovery partition and the additional features it provides make controls that do not allow the user to boot into the recovery partition less attractive. Starting in Late 2010 with the MacBook Air Apple has slowly updated the requirements to recover from a lost firmware password. Apple only supports taking the computer to an Apple authorized service provider. This change makes managing the firmware password well if used more critical. Setting the firmware password may be good practice in some environments. We cannot recommend it as a standard security practice at this time. http://support.apple.com/kb/ts3554 https://jamfnation.jamfsoftware.com/article.html?id=58 http://derflounder.wordpress.com/2012/02/05/protecting-yourself-against-firewire-dma-attacks-on-10-7-x/ http://derflounder.wordpress.com/2013/04/26/booting-into-single-user-mode-on-a-filevault-2-encrypted-mac/\"\n  impact 0.0\nend\n","source_location":{"line":808,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[]},{"id":"xccdf_org.cisecurity.benchmarks_rule_7.9_Apple_ID_password_reset","title":"Apple ID password reset","desc":"Apple has a service that will allow a user that has turned it on to reset their login password by signing in to Apple with their Apple ID. This sounds like a service that needs to be explicitly turned off in an Enterprise environment. There are however many factors here.\n             You cannot reset your password if the computer is using FileVault You cannot reset anything but a local account You need physical access to the computer on a network that can phone home to Apple The current login keychain will have to be discarded unless the user remembers the old password\n             The main use case I see for disabling this service is where you are not using FileVault to encrypt the Mac but are using Firmware controls to limit boot options with local accounts. Otherwise the user has other options for resetting a password that are more time consuming but just as effective when they have physical access to the computer.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.9_Apple_ID_password_reset\" do\n  title \"Apple ID password reset\"\n  desc  \"Apple has a service that will allow a user that has turned it on to reset their login password by signing in to Apple with their Apple ID. This sounds like a service that needs to be explicitly turned off in an Enterprise environment. There are however many factors here.\\n             You cannot reset your password if the computer is using FileVault You cannot reset anything but a local account You need physical access to the computer on a network that can phone home to Apple The current login keychain will have to be discarded unless the user remembers the old password\\n             The main use case I see for disabling this service is where you are not using FileVault to encrypt the Mac but are using Firmware controls to limit boot options with local accounts. Otherwise the user has other options for resetting a password that are more time consuming but just as effective when they have physical access to the computer.\"\n  impact 0.0\nend\n","source_location":{"line":814,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[]},{"id":"xccdf_org.cisecurity.benchmarks_rule_7.10_Repairing_permissions_is_no_longer_needed_with_10.11","title":"Repairing permissions is no longer needed with 10.11","desc":"With the introduction of System Integrity Protection (SIP) Apple has removed the necessity of repairing permissions. In earlier versions of the Operating System repair permissions checked the receipt files of installed software and ensured that the existing permissions in the file system matched what the receipts said it should. System integrity protection manages and blocks permission to certain directories continuously.\n             About OS X 10.11 #x2018;El Capitan#x2019; and Permissions Fixes\n            \n            \n                System Integrity Protection\n               \n            \n            \n                Sorry, Unix fans: OS X El Capitan kills root","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.10_Repairing_permissions_is_no_longer_needed_with_10.11\" do\n  title \"Repairing permissions is no longer needed with 10.11\"\n  desc  \"With the introduction of System Integrity Protection (SIP) Apple has removed the necessity of repairing permissions. In earlier versions of the Operating System repair permissions checked the receipt files of installed software and ensured that the existing permissions in the file system matched what the receipts said it should. System integrity protection manages and blocks permission to certain directories continuously.\\n             About OS X 10.11 #x2018;El Capitan#x2019; and Permissions Fixes\\n            \\n            \\n                System Integrity Protection\\n               \\n            \\n            \\n                Sorry, Unix fans: OS X El Capitan kills root\"\n  impact 0.0\nend\n","source_location":{"line":820,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[]},{"id":"xccdf_org.cisecurity.benchmarks_rule_7.11_App_Store_Password_Settings","title":"App Store Password Settings","desc":"With OS X 10.11 Apple has added settings for password storage for the App Store in OS X. These settings parallel the settings in iOS. As with iOS the choices are a requirement to provide a password after every purchase or to have a 15 minute grace period, and whether to require a password for free purchases. The response to this setting is stored in a cookie and processed by iCloud. There is plenty of risk information on the wisdom of this setting for parents with children buying games on iPhones and iPads. the most relevant information here is the likelihood that users that are not authorized to download software may have physical access to an unlocked computer where someone who is authorized recently made a purchase. If that is a concern a password should be required at all times for App Store access in the Password Settings controls","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.11_App_Store_Password_Settings\" do\n  title \"App Store Password Settings\"\n  desc  \"With OS X 10.11 Apple has added settings for password storage for the App Store in OS X. These settings parallel the settings in iOS. As with iOS the choices are a requirement to provide a password after every purchase or to have a 15 minute grace period, and whether to require a password for free purchases. The response to this setting is stored in a cookie and processed by iCloud. There is plenty of risk information on the wisdom of this setting for parents with children buying games on iPhones and iPads. the most relevant information here is the likelihood that users that are not authorized to download software may have physical access to an unlocked computer where someone who is authorized recently made a purchase. If that is a concern a password should be required at all times for App Store access in the Password Settings controls\"\n  impact 0.0\nend\n","source_location":{"line":826,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[]},{"id":"xccdf_org.cisecurity.benchmarks_rule_8.1_Password_Policy_Plist_generated_through_OS_X_Server","title":"Password Policy Plist generated through OS X Server","desc":"bash-3.2# pwpolicy -getaccountpoliciesGetting global account policies<?xml version=\"1.0\" encoding=\"UTF-8\"?><!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"><plist version=\"1.0\"><dict> <key>policyCategoryAuthentication</key> <array> <dict> <key>policyContent</key> <string>(policyAttributeFailedAuthentications &lt; policyAttributeMaximumFailedAuthentications) or (policyAttributeCurrentTime &gt; policyAttributeLastFailedAuthenticationTime + autoEnableInSeconds)</string> <key>policyIdentifier</key> <string>com.apple.maximumFailedLoginAttempts</string> <key>policyParameters</key> <dict> <key>autoEnableInSeconds</key> <integer>60</integer> <key>policyAttributeMaximumFailedAuthentications</key> <integer>5</integer> </dict> </dict> </array> <key>policyCategoryPasswordChange</key> <array> <dict> <key>policyContent</key> <string>policyAttributeCurrentTime &gt; policyAttributeLastPasswordChangeTime + policyAttributeExpiresEveryNDays * 24 * 60 * 60</string> <key>policyIdentifier</key> <string>com.apple.changeEveryNDays</string> <key>policyParameters</key> <dict> <key>policyAttributeExpiresEveryNDays</key> <integer>60</integer> </dict> </dict> </array> <key>policyCategoryPasswordContent</key> <array> <dict> <key>policyContent</key> <string>policyAttributePassword matches '.{15,}+'</string> <key>policyContentDescription</key> <dict> <key>de</key> <string>Das Passwort muss mindestens 15 Zeichen lang sein</string> <key>default</key> <string>Password must be a minimum of 15 characters in length</string> <key>en</key> <string>Password must be a minimum of 15 characters in length</string> <key>es</key> <string>La contrase#x00D1;a debe tener como m#x00ED;nimo 15 caracteres</string> <key>fr</key> <string>Le mot de passe doit contenir au moins 15 caract#x00E8;res</string> <key>it</key> <string>La password deve contenere almeno 15 caratteri</string> <key>ja</key> <string>パスワードは半角英数字で 15 文字以上でなければなりません</string> <key>ko</key> <string>암호는 최소 15자 이상이어야 합니다.</string> <key>nl</key> <string>Het wachtwoord moet minimaal 15 tekens lang zijn</string> <key>zh-Hans</key> <string>密码长度必须至少为 15 个字符</string> <key>zh-Hant</key> <string>密碼的長度最少必須為 15 個字元</string> </dict> <key>policyIdentifier</key> <string>com.apple.minimumPasswordLength</string> <key>policyParameters</key> <dict> <key>minimumPasswordLength</key> <integer>15</integer> </dict> </dict> <dict> <key>policyContent</key> <string>policyAttributePassword matches '(.*[A-Z].*[a-z].*)|(.*[a-z].*[A-Z].*)'</string> <key>policyContentDescription</key> <dict> <key>de</key> <string>Das Passwort muss sowohl Gro#x00DF;- als auch Kleinbuchstaben enthalten</string> <key>default</key> <string>Password must have both uppercase and lowercase letters</string> <key>en</key> <string>Password must have both uppercase and lowercase letters</string> <key>es</key> <string>La contrase#x00D1;a debe tener letras may#x00DA;sculas y min#x00DA;sculas</string> <key>fr</key> <string>Le mot de passe doit contenir des majuscules et des minuscules</string> <key>it</key> <string>La password deve contenere lettere maiuscole e minuscole</string> <key>ja</key> <string>パスワードには大文字と小文字の両方を含める必要があります</string> <key>ko</key> <string>암호는 대문자 및 소문자를 모두 포함해야 합니다.</string> <key>nl</key> <string>Het wachtwoord moet hoofdetters en kleine letters bevatten</string> <key>zh-Hans</key> <string>密码必须包含大写字母和小写字母</string> <key>zh-Hant</key> <string>密碼必須有大寫及小寫字母</string> </dict> <key>policyIdentifier</key> <string>com.apple.uppercaseAndLowercase</string> </dict> <dict> <key>policyContent</key> <string>policyAttributePassword matches '(.*[A-Za-z].*){1,}'</string> <key>policyContentDescription</key> <dict> <key>de</key> <string>Das Passwort muss mindestens 1 Buchstaben enthalten</string> <key>default</key> <string>Password must have at least 1 letter</string> <key>en</key> <string>Password must have at least 1 letter</string> <key>es</key> <string>La contrase#x00D1;a debe tener como m#x00ED;nimo 1 letra</string> <key>fr</key> <string>Le mot de passe doit contenir au moins 1 lettre</string> <key>it</key> <string>La password deve contenere almeno 1 lettera</string> <key>ja</key> <string>パスワードには 1 文字以上の英字を含める必要があります</string> <key>ko</key> <string>암호는 최소 1자의 문자를 포함해야 합니다.</string> <key>nl</key> <string>Het wachtwoord moet minimaal 1 letter bevatten</string> <key>zh-Hans</key> <string>密码必须包含至少 1 个字母</string> <key>zh-Hant</key> <string>密碼至少必須有 1 個字母</string> </dict> <key>policyIdentifier</key> <string>com.apple.minimumLetters</string> <key>policyParameters</key> <dict> <key>minimumLetters</key> <integer>1</integer> </dict> </dict> <dict> <key>policyContent</key> <string>policyAttributePassword matches '(.*[0-9].*){1,}'</string> <key>policyContentDescription</key> <dict> <key>de</key> <string>Das Passwort muss mindestens 1 Ziffer enthalten</string> <key>default</key> <string>Password must have at least 1 number</string> <key>en</key> <string>Password must have at least 1 number</string> <key>es</key> <string>La contrase#x00D1;a debe tener como m#x00ED;nimo 1 n#x00DA;mero</string> <key>fr</key> <string>Le mot de passe doit contenir au moins 1 chiffre</string> <key>it</key> <string>La password deve contenere almeno 1 numero</string> <key>ja</key> <string>パスワードには 1 個以上の数字を含める必要があります</string> <key>ko</key> <string>암호는 최소 1자의 숫자를 포함해야 합니다.</string> <key>nl</key> <string>Het wachtwoord moet minimaal 1 cijfer bevatten</string> <key>zh-Hans</key> <string>密码必须包含至少 1 个数字</string> <key>zh-Hant</key> <string>密碼至少必須有 1 個數字</string> </dict> <key>policyIdentifier</key> <string>com.apple.minimumNumerics</string> <key>policyParameters</key> <dict> <key>minimumNumerics</key> <integer>1</integer> </dict> </dict> <dict> <key>policyContent</key> <string>policyAttributePassword matches '(.*[^A-Za-z0-9].*){1,}'</string> <key>policyContentDescription</key> <dict> <key>de</key> <string>Das Passwort muss mindestens 1 Sonderzeichen enthalten</string> <key>default</key> <string>Password must have at least 1 special character</string> <key>en</key> <string>Password must have at least 1 special character</string> <key>es</key> <string>La contrase#x00D1;a debe tener como m#x00ED;nimo 1 car#x00E1;cter especial</string> <key>fr</key> <string>Le mot de passe doit contenir au moins 1 caract#x00E8;re sp#x00E9;cial</string> <key>it</key> <string>La password deve contenere almeno 1 carattere speciale</string> <key>ja</key> <string>パスワードには 1 個以上の特殊文字を含める必要があります</string> <key>ko</key> <string>암호는 최소 1자의 특수 문자를 포함해야 합니다.</string> <key>nl</key> <string>Het wachtwoord moet minimaal 1 speciaal teken bevatten</string> <key>zh-Hans</key> <string>密码必须包含至少 1 个特殊字符</string> <key>zh-Hant</key> <string>密碼至少必須有 1 個特殊字元</string> </dict> <key>policyIdentifier</key> <string>com.apple.minimumSpecialCharacters</string> <key>policyParameters</key> <dict> <key>minimumSpecialCharacters</key> <integer>1</integer> </dict> </dict> <dict> <key>policyContent</key> <string>policyAttributePassword != policyAttributeRecordName</string> <key>policyContentDescription</key> <dict> <key>de</key> <string>Das Passwort muss sich vom Accountnamen unterscheiden</string> <key>default</key> <string>Password must differ from account name</string> <key>en</key> <string>Password must differ from account name</string> <key>es</key> <string>La contrase#x00D1;a debe ser diferente del nombre de la cuenta</string> <key>fr</key> <string>Le mot de passe doit #x00EA;tre diff#x00E9;rent du nom du compte</string> <key>it</key> <string>La password deve essere diversa dal nome dell'account</string> <key>ja</key> <string>パスワードをアカウント名と同じにはできません</string> <key>ko</key> <string>암호는 계정 이름과 달라야 합니다.</string> <key>nl</key> <string>Het wachtwoord mag niet hetzelfde zijn als de accountnaam</string> <key>zh-Hans</key> <string>密码必须与帐户名称不同</string> <key>zh-Hant</key> <string>密碼必須不同於帳號名稱</string> </dict> <key>policyIdentifier</key> <string>com.apple.passwordDiffersFromName</string> </dict> <dict> <key>policyContent</key> <string>none policyAttributePasswordHashes in policyAttributePasswordHistory</string> <key>policyContentDescription</key> <dict> <key>de</key> <string>Das Passwort muss sich von den letzten 15 Passw#x00D6;rtern unterscheiden</string> <key>default</key> <string>Password must differ from past 15 passwords</string> <key>en</key> <string>Password must differ from past 15 passwords</string> <key>es</key> <string>La contrase#x00D1;a debe ser diferente de las #x00DA;ltimas 15 contrase#x00D1;as</string> <key>fr</key> <string>Le mot de passe doit #x00EA;tre diff#x00E9;rent des 15 derniers mots de passe</string> <key>it</key> <string>La password deve essere diversa dalle ultime 15 password</string> <key>ja</key> <string>パスワードは過去に使用した 15 個のパスワードと同じにはできません</string> <key>ko</key> <string>암호는 이전 15 암호와 달라야 합니다.</string> <key>nl</key> <string>Het wachtwoord mag niet hetzelfde zijn als de vorige 15 wachtwoorden</string> <key>zh-Hans</key> <string>密码必须与之前的 15 个密码不同</string> <key>zh-Hant</key> <string>密碼必須不同於前 15 組密碼</string> </dict> <key>policyIdentifier</key> <string>com.apple.passwordDiffersFromPastNPasswords</string> <key>policyParameters</key> <dict> <key>policyAttributePasswordHistoryDepth</key> <integer>15</integer> </dict> </dict> </array></dict></plist>","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_8.1_Password_Policy_Plist_generated_through_OS_X_Server\" do\n  title \"Password Policy Plist generated through OS X Server\"\n  desc  \"bash-3.2# pwpolicy -getaccountpoliciesGetting global account policies<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?><!DOCTYPE plist PUBLIC \\\"-//Apple//DTD PLIST 1.0//EN\\\" \\\"http://www.apple.com/DTDs/PropertyList-1.0.dtd\\\"><plist version=\\\"1.0\\\"><dict> <key>policyCategoryAuthentication</key> <array> <dict> <key>policyContent</key> <string>(policyAttributeFailedAuthentications &lt; policyAttributeMaximumFailedAuthentications) or (policyAttributeCurrentTime &gt; policyAttributeLastFailedAuthenticationTime + autoEnableInSeconds)</string> <key>policyIdentifier</key> <string>com.apple.maximumFailedLoginAttempts</string> <key>policyParameters</key> <dict> <key>autoEnableInSeconds</key> <integer>60</integer> <key>policyAttributeMaximumFailedAuthentications</key> <integer>5</integer> </dict> </dict> </array> <key>policyCategoryPasswordChange</key> <array> <dict> <key>policyContent</key> <string>policyAttributeCurrentTime &gt; policyAttributeLastPasswordChangeTime + policyAttributeExpiresEveryNDays * 24 * 60 * 60</string> <key>policyIdentifier</key> <string>com.apple.changeEveryNDays</string> <key>policyParameters</key> <dict> <key>policyAttributeExpiresEveryNDays</key> <integer>60</integer> </dict> </dict> </array> <key>policyCategoryPasswordContent</key> <array> <dict> <key>policyContent</key> <string>policyAttributePassword matches '.{15,}+'</string> <key>policyContentDescription</key> <dict> <key>de</key> <string>Das Passwort muss mindestens 15 Zeichen lang sein</string> <key>default</key> <string>Password must be a minimum of 15 characters in length</string> <key>en</key> <string>Password must be a minimum of 15 characters in length</string> <key>es</key> <string>La contrase#x00D1;a debe tener como m#x00ED;nimo 15 caracteres</string> <key>fr</key> <string>Le mot de passe doit contenir au moins 15 caract#x00E8;res</string> <key>it</key> <string>La password deve contenere almeno 15 caratteri</string> <key>ja</key> <string>パスワードは半角英数字で 15 文字以上でなければなりません</string> <key>ko</key> <string>암호는 최소 15자 이상이어야 합니다.</string> <key>nl</key> <string>Het wachtwoord moet minimaal 15 tekens lang zijn</string> <key>zh-Hans</key> <string>密码长度必须至少为 15 个字符</string> <key>zh-Hant</key> <string>密碼的長度最少必須為 15 個字元</string> </dict> <key>policyIdentifier</key> <string>com.apple.minimumPasswordLength</string> <key>policyParameters</key> <dict> <key>minimumPasswordLength</key> <integer>15</integer> </dict> </dict> <dict> <key>policyContent</key> <string>policyAttributePassword matches '(.*[A-Z].*[a-z].*)|(.*[a-z].*[A-Z].*)'</string> <key>policyContentDescription</key> <dict> <key>de</key> <string>Das Passwort muss sowohl Gro#x00DF;- als auch Kleinbuchstaben enthalten</string> <key>default</key> <string>Password must have both uppercase and lowercase letters</string> <key>en</key> <string>Password must have both uppercase and lowercase letters</string> <key>es</key> <string>La contrase#x00D1;a debe tener letras may#x00DA;sculas y min#x00DA;sculas</string> <key>fr</key> <string>Le mot de passe doit contenir des majuscules et des minuscules</string> <key>it</key> <string>La password deve contenere lettere maiuscole e minuscole</string> <key>ja</key> <string>パスワードには大文字と小文字の両方を含める必要があります</string> <key>ko</key> <string>암호는 대문자 및 소문자를 모두 포함해야 합니다.</string> <key>nl</key> <string>Het wachtwoord moet hoofdetters en kleine letters bevatten</string> <key>zh-Hans</key> <string>密码必须包含大写字母和小写字母</string> <key>zh-Hant</key> <string>密碼必須有大寫及小寫字母</string> </dict> <key>policyIdentifier</key> <string>com.apple.uppercaseAndLowercase</string> </dict> <dict> <key>policyContent</key> <string>policyAttributePassword matches '(.*[A-Za-z].*){1,}'</string> <key>policyContentDescription</key> <dict> <key>de</key> <string>Das Passwort muss mindestens 1 Buchstaben enthalten</string> <key>default</key> <string>Password must have at least 1 letter</string> <key>en</key> <string>Password must have at least 1 letter</string> <key>es</key> <string>La contrase#x00D1;a debe tener como m#x00ED;nimo 1 letra</string> <key>fr</key> <string>Le mot de passe doit contenir au moins 1 lettre</string> <key>it</key> <string>La password deve contenere almeno 1 lettera</string> <key>ja</key> <string>パスワードには 1 文字以上の英字を含める必要があります</string> <key>ko</key> <string>암호는 최소 1자의 문자를 포함해야 합니다.</string> <key>nl</key> <string>Het wachtwoord moet minimaal 1 letter bevatten</string> <key>zh-Hans</key> <string>密码必须包含至少 1 个字母</string> <key>zh-Hant</key> <string>密碼至少必須有 1 個字母</string> </dict> <key>policyIdentifier</key> <string>com.apple.minimumLetters</string> <key>policyParameters</key> <dict> <key>minimumLetters</key> <integer>1</integer> </dict> </dict> <dict> <key>policyContent</key> <string>policyAttributePassword matches '(.*[0-9].*){1,}'</string> <key>policyContentDescription</key> <dict> <key>de</key> <string>Das Passwort muss mindestens 1 Ziffer enthalten</string> <key>default</key> <string>Password must have at least 1 number</string> <key>en</key> <string>Password must have at least 1 number</string> <key>es</key> <string>La contrase#x00D1;a debe tener como m#x00ED;nimo 1 n#x00DA;mero</string> <key>fr</key> <string>Le mot de passe doit contenir au moins 1 chiffre</string> <key>it</key> <string>La password deve contenere almeno 1 numero</string> <key>ja</key> <string>パスワードには 1 個以上の数字を含める必要があります</string> <key>ko</key> <string>암호는 최소 1자의 숫자를 포함해야 합니다.</string> <key>nl</key> <string>Het wachtwoord moet minimaal 1 cijfer bevatten</string> <key>zh-Hans</key> <string>密码必须包含至少 1 个数字</string> <key>zh-Hant</key> <string>密碼至少必須有 1 個數字</string> </dict> <key>policyIdentifier</key> <string>com.apple.minimumNumerics</string> <key>policyParameters</key> <dict> <key>minimumNumerics</key> <integer>1</integer> </dict> </dict> <dict> <key>policyContent</key> <string>policyAttributePassword matches '(.*[^A-Za-z0-9].*){1,}'</string> <key>policyContentDescription</key> <dict> <key>de</key> <string>Das Passwort muss mindestens 1 Sonderzeichen enthalten</string> <key>default</key> <string>Password must have at least 1 special character</string> <key>en</key> <string>Password must have at least 1 special character</string> <key>es</key> <string>La contrase#x00D1;a debe tener como m#x00ED;nimo 1 car#x00E1;cter especial</string> <key>fr</key> <string>Le mot de passe doit contenir au moins 1 caract#x00E8;re sp#x00E9;cial</string> <key>it</key> <string>La password deve contenere almeno 1 carattere speciale</string> <key>ja</key> <string>パスワードには 1 個以上の特殊文字を含める必要があります</string> <key>ko</key> <string>암호는 최소 1자의 특수 문자를 포함해야 합니다.</string> <key>nl</key> <string>Het wachtwoord moet minimaal 1 speciaal teken bevatten</string> <key>zh-Hans</key> <string>密码必须包含至少 1 个特殊字符</string> <key>zh-Hant</key> <string>密碼至少必須有 1 個特殊字元</string> </dict> <key>policyIdentifier</key> <string>com.apple.minimumSpecialCharacters</string> <key>policyParameters</key> <dict> <key>minimumSpecialCharacters</key> <integer>1</integer> </dict> </dict> <dict> <key>policyContent</key> <string>policyAttributePassword != policyAttributeRecordName</string> <key>policyContentDescription</key> <dict> <key>de</key> <string>Das Passwort muss sich vom Accountnamen unterscheiden</string> <key>default</key> <string>Password must differ from account name</string> <key>en</key> <string>Password must differ from account name</string> <key>es</key> <string>La contrase#x00D1;a debe ser diferente del nombre de la cuenta</string> <key>fr</key> <string>Le mot de passe doit #x00EA;tre diff#x00E9;rent du nom du compte</string> <key>it</key> <string>La password deve essere diversa dal nome dell'account</string> <key>ja</key> <string>パスワードをアカウント名と同じにはできません</string> <key>ko</key> <string>암호는 계정 이름과 달라야 합니다.</string> <key>nl</key> <string>Het wachtwoord mag niet hetzelfde zijn als de accountnaam</string> <key>zh-Hans</key> <string>密码必须与帐户名称不同</string> <key>zh-Hant</key> <string>密碼必須不同於帳號名稱</string> </dict> <key>policyIdentifier</key> <string>com.apple.passwordDiffersFromName</string> </dict> <dict> <key>policyContent</key> <string>none policyAttributePasswordHashes in policyAttributePasswordHistory</string> <key>policyContentDescription</key> <dict> <key>de</key> <string>Das Passwort muss sich von den letzten 15 Passw#x00D6;rtern unterscheiden</string> <key>default</key> <string>Password must differ from past 15 passwords</string> <key>en</key> <string>Password must differ from past 15 passwords</string> <key>es</key> <string>La contrase#x00D1;a debe ser diferente de las #x00DA;ltimas 15 contrase#x00D1;as</string> <key>fr</key> <string>Le mot de passe doit #x00EA;tre diff#x00E9;rent des 15 derniers mots de passe</string> <key>it</key> <string>La password deve essere diversa dalle ultime 15 password</string> <key>ja</key> <string>パスワードは過去に使用した 15 個のパスワードと同じにはできません</string> <key>ko</key> <string>암호는 이전 15 암호와 달라야 합니다.</string> <key>nl</key> <string>Het wachtwoord mag niet hetzelfde zijn als de vorige 15 wachtwoorden</string> <key>zh-Hans</key> <string>密码必须与之前的 15 个密码不同</string> <key>zh-Hant</key> <string>密碼必須不同於前 15 組密碼</string> </dict> <key>policyIdentifier</key> <string>com.apple.passwordDiffersFromPastNPasswords</string> <key>policyParameters</key> <dict> <key>policyAttributePasswordHistoryDepth</key> <integer>15</integer> </dict> </dict> </array></dict></plist>\"\n  impact 0.0\nend\n","source_location":{"line":832,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[]},{"id":"xccdf_org.cisecurity.benchmarks_rule_8.2_Password_Policy_Plist_from_man_page","title":"Password Policy Plist from man page","desc":"<?xml version=\"1.0\" encoding=\"UTF-8\"?><!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"><plist version=\"1.0\"><dict> <key>policyCategoryAuthentication</key> <array> <dict> <key>policyContent</key> <string>policyAttributeFailedAuthentications &lt; policyAttributeMaximumFailedAuthentications</string> <key>policyIdentifier</key> <string>com.apple.policy.legacy.maxFailedLoginAttempts</string> <key>policyParameters</key> <dict> <key>policyAttributeMaximumFailedAuthentications</key> <integer>5</integer> </dict> </dict> <key>policyCategoryPasswordContent</key> <string>policyAttributePassword matches #x2018;.{15,}+#x2019;</string> <key>policyIdentifier</key> <string>com.apple.policy.legacy.minChars</string> <key>policyParameters</key> <dict> <key>minimumLength</key> <integer>15</integer> </dict> <dict> <key>policyContent</key> <string>policyAttributePassword matches #x2018;.{15,}+#x2019;</string> <key>policyIdentifier</key> <string>com.apple.policy.legacy.minChars</string> <key>policyParameters</key> <dict> <key>minimumLength</key> <integer>15</integer> </dict> </dict> <dict> <key>policyContent</key> <string>policyAttributePassword matches '(.*[a-zA-Z].*){1,}+'</string> <key>policyIdentifier</key> <string>com.apple.policy.legacy.requiresAlpha</string> <key>policyParameters</key> <dict> <key>minimumAlphaCharacters</key> <integer>1</integer> </dict> </dict> <dict> <key>policyContent</key> <string>policyAttributePassword matches '(.*[0-9].*){1,}+'</string> <key>policyIdentifier</key> <string>com.apple.policy.legacy.requiresNumeric</string> <key>policyParameters</key> <dict> <key>minimumNumericCharacters</key> <integer>1</integer> </dict> </dict> <dict> <key>policyContent</key> <string>policyAttributePassword matches '(.*[`~!@#$%^&amp;*()_+-={}|\\[\\]\\\\:\";'&lt;&gt;?,./].*){1,}+'</string> <key>policyIdentifier</key> <string>com.apple.policy.legacy.requiresSymbol</string> <key>policyParameters</key> <dict> <key>minimumSymbolCharacters</key> <integer>1</integer> </dict> </dict> </array></dict></plist>","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_8.2_Password_Policy_Plist_from_man_page\" do\n  title \"Password Policy Plist from man page\"\n  desc  \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?><!DOCTYPE plist PUBLIC \\\"-//Apple//DTD PLIST 1.0//EN\\\" \\\"http://www.apple.com/DTDs/PropertyList-1.0.dtd\\\"><plist version=\\\"1.0\\\"><dict> <key>policyCategoryAuthentication</key> <array> <dict> <key>policyContent</key> <string>policyAttributeFailedAuthentications &lt; policyAttributeMaximumFailedAuthentications</string> <key>policyIdentifier</key> <string>com.apple.policy.legacy.maxFailedLoginAttempts</string> <key>policyParameters</key> <dict> <key>policyAttributeMaximumFailedAuthentications</key> <integer>5</integer> </dict> </dict> <key>policyCategoryPasswordContent</key> <string>policyAttributePassword matches #x2018;.{15,}+#x2019;</string> <key>policyIdentifier</key> <string>com.apple.policy.legacy.minChars</string> <key>policyParameters</key> <dict> <key>minimumLength</key> <integer>15</integer> </dict> <dict> <key>policyContent</key> <string>policyAttributePassword matches #x2018;.{15,}+#x2019;</string> <key>policyIdentifier</key> <string>com.apple.policy.legacy.minChars</string> <key>policyParameters</key> <dict> <key>minimumLength</key> <integer>15</integer> </dict> </dict> <dict> <key>policyContent</key> <string>policyAttributePassword matches '(.*[a-zA-Z].*){1,}+'</string> <key>policyIdentifier</key> <string>com.apple.policy.legacy.requiresAlpha</string> <key>policyParameters</key> <dict> <key>minimumAlphaCharacters</key> <integer>1</integer> </dict> </dict> <dict> <key>policyContent</key> <string>policyAttributePassword matches '(.*[0-9].*){1,}+'</string> <key>policyIdentifier</key> <string>com.apple.policy.legacy.requiresNumeric</string> <key>policyParameters</key> <dict> <key>minimumNumericCharacters</key> <integer>1</integer> </dict> </dict> <dict> <key>policyContent</key> <string>policyAttributePassword matches '(.*[`~!@\\#$%^&amp;*()_+-={}|\\\\[\\\\]\\\\\\\\:\\\";'&lt;&gt;?,./].*){1,}+'</string> <key>policyIdentifier</key> <string>com.apple.policy.legacy.requiresSymbol</string> <key>policyParameters</key> <dict> <key>minimumSymbolCharacters</key> <integer>1</integer> </dict> </dict> </array></dict></plist>\"\n  impact 0.0\nend\n","source_location":{"line":838,"ref":"Desktop/cis-appleosx10.11-level2/controls/translated-controls.rb"},"results":[]}]}],"statistics":{"duration":57.447338},"version":"2.0.32"}